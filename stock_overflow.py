from ta.momentum import RSIIndicator
from ta.trend import MACD
import pandas as pd
import ta
import yfinance
from ta.volatility import BollingerBands
import numpy as np
import pandas_datareader as dr
import datetime
import plotly.graph_objects as go
import plotly.express as px
from ta.volume import AccDistIndexIndicator
from ta.volume import ChaikinMoneyFlowIndicator
import nsepy
from nsepy import get_history
import plotly.graph_objects as go
import dash
import dash_core_components as dcc
import dash_html_components as html
from dash.dependencies import Input, Output,State
import random
from scipy.signal import argrelextrema
from collections import defaultdict
from sklearn.metrics.pairwise import cosine_similarity
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.feature_extraction import text
from sklearn.feature_extraction.text import TfidfTransformer
from sklearn.feature_extraction.text import TfidfVectorizer
#other python files



dt=datetime.date.today()
pd.options.display.max_columns=None
pd.options.mode.chained_assignment = None

nifty_500=['3MINDIA', 'ABB', 'POWERINDIA', 'ACC', 'AIAENG', 'APLAPOLLO', 'AUBANK', 'AARTIDRUGS', 'AARTIIND', 'AAVAS', 'ABBOTINDIA', 'ADANIENT', 'ADANIGREEN', 'ADANIPORTS', 'ATGL', 'ADANITRANS', 'ABCAPITAL', 'ABFRL', 'ADVENZYMES', 'AEGISCHEM', 'AFFLE', 'AJANTPHARM', 'AKZOINDIA', 'ALEMBICLTD', 'APLLTD', 'ALKEM', 'ALKYLAMINE', 'ALOKINDS', 'AMARAJABAT', 'AMBER', 'AMBUJACEM', 'ANGELBRKG', 'APOLLOHOSP', 'APOLLOTYRE', 'ASAHIINDIA', 'ASHOKLEY', 'ASHOKA', 'ASIANPAINT', 'ASTERDM', 'ASTRAZEN', 'ASTRAL', 'ATUL', 'AUROPHARMA', 'AVANTIFEED', 'DMART', 'AXISBANK', 'BASF', 'BEML', 'BSE', 'BAJAJ-AUTO', 'BAJAJCON', 'BAJAJELEC', 'BAJFINANCE', 'BAJAJFINSV', 'BAJAJHLDNG', 'BALAMINES', 'BALKRISIND', 'BALMLAWRIE', 'BALRAMCHIN', 'BANDHANBNK', 'BANKBARODA', 'BANKINDIA', 'MAHABANK', 'BATAINDIA', 'BAYERCROP', 'BERGEPAINT', 'BDL', 'BEL', 'BHARATFORG', 'BHEL', 'BPCL', 'BHARATRAS', 'BHARTIARTL', 'BIOCON', 'BIRLACORPN', 'BSOFT', 'BLISSGVS', 'BLUEDART', 'BLUESTARCO', 'BBTC', 'BOSCHLTD', 'BRIGADE', 'BRITANNIA', 'BURGERKING', 'CCL', 'CESC', 'CRISIL', 'CSBBANK', 'CADILAHC', 'CANFINHOME', 'CANBK', 'CAPLIPOINT', 'CGCL', 'CARBORUNIV', 'CASTROLIND', 'CEATLTD', 'CENTRALBK', 'CDSL', 'CENTURYPLY', 'CENTURYTEX', 'CERA', 'CHALET', 'CHAMBLFERT', 'CHOLAHLDNG', 'CHOLAFIN', 'CIPLA', 'CUB', 'COALINDIA', 'COCHINSHIP', 'COFORGE', 'COLPAL', 'CAMS', 'CONCOR', 'COROMANDEL', 'CREDITACC', 'CROMPTON', 'CUMMINSIND', 'CYIENT', 'DCBBANK', 'DCMSHRIRAM', 'DLF', 'DABUR', 'DALBHARAT', 'DEEPAKNTR', 'DELTACORP', 'DHANI', 'DHANUKA', 'DBL', 'DISHTV', 'DCAL', 'DIVISLAB', 'DIXON', 'LALPATHLAB', 'DRREDDY', 'EIDPARRY', 'EIHOTEL', 'EPL', 'EDELWEISS', 'EICHERMOT', 'ELGIEQUIP', 'EMAMILTD', 'ENDURANCE', 'ENGINERSIN', 'EQUITAS', 'ERIS', 'ESCORTS', 'EXIDEIND', 'FDC', 'FEDERALBNK', 'FINEORG', 'FINCABLES', 'FINPIPE', 'FSL', 'FORTIS', 'FCONSUMER', 'FRETAIL', 'GAIL', 'GEPIL', 'GMMPFAUDLR', 'GMRINFRA', 'GALAXYSURF', 'GRSE', 'GARFIBRES', 'GICRE', 'GILLETTE', 'GLAXO', 'GLENMARK', 'GODFRYPHLP', 'GODREJAGRO', 'GODREJCP', 'GODREJIND', 'GODREJPROP', 'GRANULES', 'GRAPHITE', 'GRASIM', 'GESHIP', 'GREAVESCOT', 'GRINDWELL', 'GUJALKALI', 'GAEL', 'FLUOROCHEM', 'GUJGASLTD', 'GNFC', 'GPPL', 'GSFC', 'GSPL', 'GULFOILLUB', 'HEG', 'HCLTECH', 'HDFCAMC', 'HDFCBANK', 'HDFCLIFE', 'HFCL', 'HAPPSTMNDS', 'HATSUN', 'HAVELLS', 'HEIDELBERG', 'HEMIPROP', 'HEROMOTOCO', 'HSCL', 'HINDALCO', 'HAL', 'HINDCOPPER', 'HINDPETRO', 'HINDUNILVR', 'HINDZINC', 'HONAUT', 'HUDCO', 'HDFC', 'HUHTAMAKI', 'ICICIBANK', 'ICICIGI', 'ICICIPRULI', 'ISEC', 'IDBI', 'IDFCFIRSTB', 'IDFC', 'IFBIND', 'IIFL', 'IIFLWAM', 'IOLCP', 'IRB', 'IRCON', 'ITC', 'ITI', 'INDIACEM', 'IBULHSGFIN', 'IBREALEST', 'INDIAMART', 'INDIANB', 'IEX', 'INDHOTEL', 'IOC', 'IOB', 'IRCTC', 'ICIL', 'INDOCO', 'IGL', 'INDUSTOWER', 'INDUSINDBK', 'INFIBEAM', 'NAUKRI', 'INFY', 'INGERRAND', 'INOXLEISUR', 'INTELLECT', 'INDIGO', 'IPCALAB', 'JBCHEPHARM', 'JKCEMENT', 'JKLAKSHMI', 'JKPAPER', 'JKTYRE', 'JMFINANCIL', 'JSWENERGY', 'JSWSTEEL', 'JTEKTINDIA', 'JAMNAAUTO', 'JINDALSAW', 'JSLHISAR', 'JSL', 'JINDALSTEL', 'JCHAC', 'JUBLFOOD', 'JUSTDIAL', 'JYOTHYLAB', 'KPRMILL', 'KEI', 'KNRCON', 'KPITTECH', 'KRBL', 'KSB', 'KAJARIACER', 'KALPATPOWR', 'KANSAINER', 'KARURVYSYA', 'KSCL', 'KEC', 'KOTAKBANK', 'L&TFH', 'LTTS', 'LICHSGFIN', 'LAOPALA', 'LAXMIMACH', 'LTI', 'LT', 'LAURUSLABS', 'LEMONTREE', 'LINDEINDIA', 'LUPIN', 'LUXIND', 'MASFIN', 'MMTC', 'MOIL', 'MRF', 'MGL', 'MAHSCOOTER', 'MAHSEAMLES', 'M&MFIN', 'M&M', 'MAHINDCIE', 'MHRIL', 'MAHLOG', 'MANAPPURAM', 'MRPL', 'MARICO', 'MARUTI', 'MFSL', 'MAXHEALTH', 'MAZDOCK', 'METROPOLIS', 'MINDTREE', 'MINDACORP', 'MINDAIND', 'MIDHANI', 'MOTHERSUMI', 'MOTILALOFS', 'MPHASIS', 'MCX', 'MUTHOOTFIN', 'NATCOPHARM', 'NBCC', 'NCC', 'NESCO', 'NHPC', 'NLCINDIA', 'NMDC', 'NOCIL', 'NTPC', 'NH', 'NATIONALUM', 'NFL', 'NAVINFLUOR', 'NESTLEIND', 'NETWORK18', 'NILKAMAL', 'NAM-INDIA', 'OBEROIRLTY', 'ONGC', 'OIL', 'OFSS', 'ORIENTELEC', 'ORIENTREF', 'PIIND', 'PNBHOUSING', 'PNCINFRA', 'PVR', 'PAGEIND', 'PERSISTENT', 'PETRONET', 'PFIZER', 'PHILIPCARB', 'PHOENIXLTD', 'PIDILITIND', 'PEL', 'POLYMED', 'POLYCAB', 'POLYPLEX', 'PFC', 'POWERGRID', 'PRESTIGE', 'PRINCEPIPE', 'PRSMJOHNSN', 'PGHL', 'PGHH', 'PNB', 'QUESS', 'RBLBANK', 'RECLTD', 'RITES', 'RADICO', 'RVNL', 'RAIN', 'RAJESHEXPO', 'RALLIS', 'RCF', 'RATNAMANI', 'RAYMOND', 'REDINGTON', 'RELAXO', 'RELIANCE', 'RESPONIND', 'ROSSARI', 'ROUTE', 'SBICARD', 'SBILIFE', 'SIS', 'SJVN', 'SKFINDIA', 'SRF', 'SANOFI', 'SCHAEFFLER', 'SCHNEIDER', 'SEQUENT', 'SHARDACROP', 'SFL', 'SHILPAMED', 'SCI', 'SHOPERSTOP', 'SHREECEM', 'SHRIRAMCIT', 'SRTRANSFIN', 'SIEMENS', 'SOBHA', 'SOLARINDS', 'SOLARA', 'SONATSOFTW', 'SPANDANA', 'SPICEJET', 'STARCEMENT', 'SBIN', 'SAIL', 'SWSOLAR', 'STLTECH', 'STAR', 'SUDARSCHEM', 'SUMICHEM', 'SPARC', 'SUNPHARMA', 'SUNTV', 'SUNCLAYLTD', 'SUNDARMFIN', 'SUNDRMFAST', 'SUNTECK', 'SUPRAJIT', 'SUPREMEIND', 'SUPPETRO', 'SUVENPHAR', 'SUZLON', 'SWANENERGY', 'SYMPHONY', 'SYNGENE', 'TCIEXP', 'TCNSBRANDS', 'TTKPRESTIG', 'TV18BRDCST', 'TVSMOTOR', 'TANLA', 'TASTYBITE', 'TATACHEM', 'TATACOFFEE', 'TATACOMM', 'TCS', 'TATACONSUM', 'TATAELXSI', 'TATAINVEST', 'TATAMTRDVR', 'TATAMOTORS', 'TATAPOWER', 'TATASTEEL', 'TEAMLEASE', 'TECHM', 'NIACL', 'RAMCOCEM', 'THERMAX', 'THYROCARE', 'TIMKEN', 'TITAN', 'TORNTPHARM', 'TORNTPOWER', 'TRENT', 'TRIDENT', 'TRITURBINE', 'TIINDIA', 'UCOBANK', 'UFLEX', 'UPL', 'UTIAMC', 'UJJIVAN', 'UJJIVANSFB', 'ULTRACEMCO', 'UNIONBANK', 'UBL', 'MCDOWELL-N', 'VGUARD', 'VMART', 'VIPIND', 'VSTIND', 'VAIBHAVGBL', 'VAKRANGEE', 'VALIANTORG', 'VTL', 'VARROC', 'VBL', 'VEDL', 'VENKEYS', 'VINATIORGA', 'IDEA', 'VOLTAS', 'WABCOINDIA', 'WELCORP', 'WELSPUNIND', 'WESTLIFE', 'WHIRLPOOL', 'WIPRO', 'WOCKPHARMA', 'YESBANK', 'ZEEL', 'ZENSARTECH', 'ZYDUSWELL', 'ECLERX']
d500={'3MINDIA': '3M India Limited', 'AARTIDRUGS': 'Aarti Drugs Limited', 'AARTIIND': 'Aarti Industries Limited', 'AAVAS': 'Aavas Financiers Limited', 'ABB': 'ABB India Limited', 'ABBOTINDIA': 'Abbott India Limited', 'ABCAPITAL': 'Aditya Birla Capital Limited', 'ABFRL': 'Aditya Birla Fashion and Retail Limited', 'ACC': 'ACC Limited', 'ADANIENT': 'Adani Enterprises Limited', 'ADANIGREEN': 'Adani Green Energy Limited', 'ADANIPORTS': 'Adani Ports and Special Economic Zone Limited', 'ADANITRANS': 'Adani Transmission Limited', 'ADVENZYMES': 'Advanced Enzyme Technologies Limited', 'AEGISCHEM': 'Aegis Logistics Limited', 'AFFLE': 'Affle (India) Limited', 'AIAENG': 'AIA Engineering Limited', 'AJANTPHARM': 'Ajanta Pharma Limited', 'AKZOINDIA': 'Akzo Nobel India Limited', 'ALEMBICLTD': 'Alembic Limited', 'ALKEM': 'Alkem Laboratories Limited', 'ALKYLAMINE': 'Alkyl Amines Chemicals Limited', 'ALOKINDS': 'Alok Industries Limited', 'AMARAJABAT': 'Amara Raja Batteries Limited', 'AMBER': 'Amber Enterprises India Limited', 'AMBUJACEM': 'Ambuja Cements Limited', 'ANGELBRKG': 'Angel Broking Limited', 'APLAPOLLO': 'APL Apollo Tubes Limited', 'APLLTD': 'Alembic Pharmaceuticals Limited', 'APOLLOHOSP': 'Apollo Hospitals Enterprise Limited', 'APOLLOTYRE': 'Apollo Tyres Limited', 'ASAHIINDIA': 'Asahi India Glass Limited', 'ASHOKA': 'Ashoka Buildcon Limited', 'ASHOKLEY': 'Ashok Leyland Limited', 'ASIANPAINT': 'Asian Paints Limited', 'ASTERDM': 'Aster DM Healthcare Limited', 'ASTRAL': 'Astral Poly Technik Limited', 'ASTRAZEN': 'AstraZeneca Pharma India Limited', 'ATGL': 'Adani Total Gas Limited', 'ATUL': 'Atul Limited', 'AUBANK': 'AU Small Finance Bank Limited', 'AUROPHARMA': 'Aurobindo Pharma Limited', 'AVANTIFEED': 'Avanti Feeds Limited', 'AXISBANK': 'Axis Bank Limited', 'BAJAJ-AUTO': 'Bajaj Auto Limited', 'BAJAJCON': 'Bajaj Consumer Care Limited', 'BAJAJELEC': 'Bajaj Electricals Limited', 'BAJAJFINSV': 'Bajaj Finserv Limited', 'BAJAJHLDNG': 'Bajaj Holdings & Investment Limited', 'BAJFINANCE': 'Bajaj Finance Limited', 'BALAMINES': 'Balaji Amines Limited', 'BALKRISIND': 'Balkrishna Industries Limited', 'BALMLAWRIE': 'Balmer Lawrie & Company Limited', 'BALRAMCHIN': 'Balrampur Chini Mills Limited', 'BANDHANBNK': 'Bandhan Bank Limited', 'BANKBARODA': 'Bank of Baroda', 'BANKINDIA': 'Bank of India', 'BASF': 'BASF India Limited', 'BATAINDIA': 'Bata India Limited', 'BAYERCROP': 'Bayer Cropscience Limited', 'BBTC': 'Bombay Burmah Trading Corporation Limited', 'BDL': 'Bharat Dynamics Limited', 'BEL': 'Bharat Electronics Limited', 'BEML': 'BEML Limited', 'BERGEPAINT': 'Berger Paints (I) Limited', 'BHARATFORG': 'Bharat Forge Limited', 'BHARATRAS': 'Bharat Rasayan Limited', 'BHARTIARTL': 'Bharti Airtel Limited', 'BHEL': 'Bharat Heavy Electricals Limited', 'BIOCON': 'Biocon Limited', 'BIRLACORPN': 'Birla Corporation Limited', 'BLISSGVS': 'Bliss GVS Pharma Limited', 'BLUEDART': 'Blue Dart Express Limited', 'BLUESTARCO': 'Blue Star Limited', 'BOSCHLTD': 'Bosch Limited', 'BPCL': 'Bharat Petroleum Corporation Limited', 'BRIGADE': 'Brigade Enterprises Limited', 'BRITANNIA': 'Britannia Industries Limited', 'BSE': 'BSE Limited', 'BSOFT': 'BIRLASOFT LIMITED', 'BURGERKING': 'Burger King India Limited', 'CADILAHC': 'Cadila Healthcare Limited', 'CAMS': 'Computer Age Management Services Limited', 'CANBK': 'Canara Bank', 'CANFINHOME': 'Can Fin Homes Limited', 'CAPLIPOINT': 'Caplin Point Laboratories Limited', 'CARBORUNIV': 'Carborundum Universal Limited', 'CASTROLIND': 'Castrol India Limited', 'CCL': 'CCL Products (India) Limited', 'CDSL': 'Central Depository Services (India) Limited', 'CEATLTD': 'CEAT Limited', 'CENTRALBK': 'Central Bank of India', 'CENTURYPLY': 'Century Plyboards (India) Limited', 'CENTURYTEX': 'Century Textiles & Industries Limited', 'CERA': 'Cera Sanitaryware Limited', 'CESC': 'CESC Limited', 'CGCL': 'Capri Global Capital Limited', 'CHALET': 'Chalet Hotels Limited', 'CHAMBLFERT': 'Chambal Fertilizers & Chemicals Limited', 'CHOLAFIN': 'Cholamandalam Investment and Finance Company Limited', 'CHOLAHLDNG': 'Cholamandalam Financial Holdings Limited', 'CIPLA': 'Cipla Limited', 'COALINDIA': 'Coal India Limited', 'COCHINSHIP': 'Cochin Shipyard Limited', 'COFORGE': 'Coforge Limited', 'COLPAL': 'Colgate Palmolive (India) Limited', 'CONCOR': 'Container Corporation of India Limited', 'COROMANDEL': 'Coromandel International Limited', 'CREDITACC': 'CREDITACCESS GRAMEEN LIMITED', 'CRISIL': 'CRISIL Limited', 'CROMPTON': 'Crompton Greaves Consumer Electricals Limited', 'CSBBANK': 'CSB Bank Limited', 'CUB': 'City Union Bank Limited', 'CUMMINSIND': 'Cummins India Limited', 'CYIENT': 'Cyient Limited', 'DABUR': 'Dabur India Limited', 'DALBHARAT': 'Dalmia Bharat Limited', 'DBL': 'Dilip Buildcon Limited', 'DCAL': 'Dishman Carbogen Amcis Limited', 'DCBBANK': 'DCB Bank Limited', 'DCMSHRIRAM': 'DCM Shriram Limited', 'DEEPAKNTR': 'Deepak Nitrite Limited', 'DELTACORP': 'Delta Corp Limited', 'DHANI': 'Dhani Services Limited', 'DHANUKA': 'Dhanuka Agritech Limited', 'DISHTV': 'Dish TV India Limited', 'DIVISLAB': "Divi's Laboratories Limited", 'DIXON': 'Dixon Technologies (India) Limited', 'DLF': 'DLF Limited', 'DMART': 'Avenue Supermarts Limited', 'DRREDDY': "Dr. Reddy's Laboratories Limited", 'ECLERX': 'eClerx Services Limited', 'EDELWEISS': 'Edelweiss Financial Services Limited', 'EICHERMOT': 'Eicher Motors Limited', 'EIDPARRY': 'EID Parry India Limited', 'EIHOTEL': 'EIH Limited', 'ELGIEQUIP': 'Elgi Equipments Limited', 'EMAMILTD': 'Emami Limited', 'ENDURANCE': 'Endurance Technologies Limited', 'ENGINERSIN': 'Engineers India Limited', 'EPL': 'EPL Limited', 'EQUITAS': 'Equitas Holdings Limited', 'ERIS': 'Eris Lifesciences Limited', 'ESCORTS': 'Escorts Limited', 'EXIDEIND': 'Exide Industries Limited', 'FCONSUMER': 'Future Consumer Limited', 'FDC': 'FDC Limited', 'FEDERALBNK': 'The Federal Bank  Limited', 'FINCABLES': 'Finolex Cables Limited', 'FINEORG': 'Fine Organic Industries Limited', 'FINPIPE': 'Finolex Industries Limited', 'FLUOROCHEM': 'Gujarat Fluorochemicals Limited', 'FORTIS': 'Fortis Healthcare Limited', 'FRETAIL': 'Future Retail Limited', 'FSL': 'Firstsource Solutions Limited', 'GAEL': 'Gujarat Ambuja Exports Limited', 'GAIL': 'GAIL (India) Limited', 'GALAXYSURF': 'Galaxy Surfactants Limited', 'GARFIBRES': 'Garware Technical Fibres Limited', 'GEPIL': 'GE Power India Limited', 'GESHIP': 'The Great Eastern Shipping Company Limited', 'GICRE': 'General Insurance Corporation of India', 'GILLETTE': 'Gillette India Limited', 'GLAXO': 'GlaxoSmithKline Pharmaceuticals Limited', 'GLENMARK': 'Glenmark Pharmaceuticals Limited', 'GMMPFAUDLR': 'GMM Pfaudler Limited', 'GMRINFRA': 'GMR Infrastructure Limited', 'GNFC': 'Gujarat Narmada Valley Fertilizers and Chemicals Limited', 'GODFRYPHLP': 'Godfrey Phillips India Limited', 'GODREJAGRO': 'Godrej Agrovet Limited', 'GODREJCP': 'Godrej Consumer Products Limited', 'GODREJIND': 'Godrej Industries Limited', 'GODREJPROP': 'Godrej Properties Limited', 'GPPL': 'Gujarat Pipavav Port Limited', 'GRANULES': 'Granules India Limited', 'GRAPHITE': 'Graphite India Limited', 'GRASIM': 'Grasim Industries Limited', 'GREAVESCOT': 'Greaves Cotton Limited', 'GRINDWELL': 'Grindwell Norton Limited', 'GRSE': 'Garden Reach Shipbuilders & Engineers Limited', 'GSFC': 'Gujarat State Fertilizers & Chemicals Limited', 'GSPL': 'Gujarat State Petronet Limited', 'GUJALKALI': 'Gujarat Alkalies and Chemicals Limited', 'GUJGASLTD': 'Gujarat Gas Limited', 'GULFOILLUB': 'Gulf Oil Lubricants India Limited', 'HAL': 'Hindustan Aeronautics Limited', 'HAPPSTMNDS': 'Happiest Minds Technologies Limited', 'HATSUN': 'Hatsun Agro Product Limited', 'HAVELLS': 'Havells India Limited', 'HCLTECH': 'HCL Technologies Limited', 'HDFC': 'Housing Development Finance Corporation Limited', 'HDFCAMC': 'HDFC Asset Management Company Limited', 'HDFCBANK': 'HDFC Bank Limited', 'HDFCLIFE': 'HDFC Life Insurance Company Limited', 'HEG': 'HEG Limited', 'HEIDELBERG': 'HeidelbergCement India Limited', 'HEMIPROP': 'Hemisphere Properties India Limited', 'HEROMOTOCO': 'Hero MotoCorp Limited', 'HFCL': 'HFCL Limited', 'HINDALCO': 'Hindalco Industries Limited', 'HINDCOPPER': 'Hindustan Copper Limited', 'HINDPETRO': 'Hindustan Petroleum Corporation Limited', 'HINDUNILVR': 'Hindustan Unilever Limited', 'HINDZINC': 'Hindustan Zinc Limited', 'HONAUT': 'Honeywell Automation India Limited', 'HSCL': 'Himadri Speciality Chemical Limited', 'HUDCO': 'Housing & Urban Development Corporation Limited', 'HUHTAMAKI': 'Huhtamaki India Limited', 'IBREALEST': 'Indiabulls Real Estate Limited', 'IBULHSGFIN': 'Indiabulls Housing Finance Limited', 'ICICIBANK': 'ICICI Bank Limited', 'ICICIGI': 'ICICI Lombard General Insurance Company Limited', 'ICICIPRULI': 'ICICI Prudential Life Insurance Company Limited', 'ICIL': 'Indo Count Industries Limited', 'IDBI': 'IDBI Bank Limited', 'IDEA': 'Vodafone Idea Limited', 'IDFC': 'IDFC Limited', 'IDFCFIRSTB': 'IDFC First Bank Limited', 'IEX': 'Indian Energy Exchange Limited', 'IFBIND': 'IFB Industries Limited', 'IGL': 'Indraprastha Gas Limited', 'IIFL': 'IIFL Finance Limited', 'IIFLWAM': 'Iifl Wealth Management Limited', 'INDHOTEL': 'The Indian Hotels Company Limited', 'INDIACEM': 'The India Cements Limited', 'INDIAMART': 'Indiamart Intermesh Limited', 'INDIANB': 'Indian Bank', 'INDIGO': 'InterGlobe Aviation Limited', 'INDOCO': 'Indoco Remedies Limited', 'INDUSINDBK': 'IndusInd Bank Limited', 'INDUSTOWER': 'Indus Towers Limited', 'INFIBEAM': 'Infibeam Avenues Limited', 'INFY': 'Infosys Limited', 'INGERRAND': 'Ingersoll Rand (India) Limited', 'INOXLEISUR': 'INOX Leisure Limited', 'INTELLECT': 'Intellect Design Arena Limited', 'IOB': 'Indian Overseas Bank', 'IOC': 'Indian Oil Corporation Limited', 'IOLCP': 'IOL Chemicals and Pharmaceuticals Limited', 'IPCALAB': 'IPCA Laboratories Limited', 'IRB': 'IRB Infrastructure Developers Limited', 'IRCON': 'Ircon International Limited', 'IRCTC': 'Indian Railway Catering And Tourism Corporation Limited', 'ISEC': 'ICICI Securities Limited', 'ITC': 'ITC Limited', 'ITI': 'ITI Limited', 'JAMNAAUTO': 'Jamna Auto Industries Limited', 'JBCHEPHARM': 'JB Chemicals & Pharmaceuticals Limited', 'JCHAC': 'Johnson Controls - Hitachi Air Conditioning India Limited', 'JINDALSAW': 'Jindal Saw Limited', 'JINDALSTEL': 'Jindal Steel & Power Limited', 'JKCEMENT': 'JK Cement Limited', 'JKLAKSHMI': 'JK Lakshmi Cement Limited', 'JKPAPER': 'JK Paper Limited', 'JKTYRE': 'JK Tyre & Industries Limited', 'JMFINANCIL': 'JM Financial Limited', 'JSL': 'Jindal Stainless Limited', 'JSLHISAR': 'Jindal Stainless (Hisar) Limited', 'JSWENERGY': 'JSW Energy Limited', 'JSWSTEEL': 'JSW Steel Limited', 'JTEKTINDIA': 'Jtekt India Limited', 'JUBLFOOD': 'Jubilant Foodworks Limited', 'JUSTDIAL': 'Just Dial Limited', 'JYOTHYLAB': 'Jyothy Labs Limited', 'KAJARIACER': 'Kajaria Ceramics Limited', 'KALPATPOWR': 'Kalpataru Power Transmission Limited', 'KANSAINER': 'Kansai Nerolac Paints Limited', 'KARURVYSYA': 'Karur Vysya Bank Limited', 'KEC': 'KEC International Limited', 'KEI': 'KEI Industries Limited', 'KNRCON': 'KNR Constructions Limited', 'KOTAKBANK': 'Kotak Mahindra Bank Limited', 'KPITTECH': 'KPIT Technologies Limited', 'KPRMILL': 'K.P.R. Mill Limited', 'KRBL': 'KRBL Limited', 'KSB': 'Ksb Limited', 'KSCL': 'Kaveri Seed Company Limited', 'L&TFH': 'L&T Finance Holdings Limited', 'LALPATHLAB': 'Dr. Lal Path Labs Ltd.', 'LAOPALA': 'La Opala RG Limited', 'LAURUSLABS': 'Laurus Labs Limited', 'LAXMIMACH': 'Lakshmi Machine Works Limited', 'LEMONTREE': 'Lemon Tree Hotels Limited', 'LICHSGFIN': 'LIC Housing Finance Limited', 'LINDEINDIA': 'Linde India Limited', 'LT': 'Larsen & Toubro Limited', 'LTI': 'Larsen & Toubro Infotech Limited', 'LTTS': 'L&T Technology Services Limited', 'LUPIN': 'Lupin Limited', 'LUXIND': 'Lux Industries Limited', 'M&M': 'Mahindra & Mahindra Limited', 'M&MFIN': 'Mahindra & Mahindra Financial Services Limited', 'MAHABANK': 'Bank of Maharashtra', 'MAHINDCIE': 'Mahindra CIE Automotive Limited', 'MAHLOG': 'Mahindra Logistics Limited', 'MAHSCOOTER': 'Maharashtra Scooters Limited', 'MAHSEAMLES': 'Maharashtra Seamless Limited', 'MANAPPURAM': 'Manappuram Finance Limited', 'MARICO': 'Marico Limited', 'MARUTI': 'Maruti Suzuki India Limited', 'MASFIN': 'MAS Financial Services Limited', 'MAXHEALTH': 'Max Healthcare Institute Limited', 'MAZDOCK': 'Mazagon Dock Shipbuilders Limited', 'MCDOWELL-N': 'United Spirits Limited', 'MCX': 'Multi Commodity Exchange of India Limited', 'METROPOLIS': 'Metropolis Healthcare Limited', 'MFSL': 'Max Financial Services Limited', 'MGL': 'Mahanagar Gas Limited', 'MHRIL': 'Mahindra Holidays & Resorts India Limited', 'MIDHANI': 'Mishra Dhatu Nigam Limited', 'MINDACORP': 'Minda Corporation Limited', 'MINDAIND': 'Minda Industries Limited', 'MINDTREE': 'MindTree Limited', 'MMTC': 'MMTC Limited', 'MOIL': 'MOIL Limited', 'MOTHERSUMI': 'Motherson Sumi Systems Limited', 'MOTILALOFS': 'Motilal Oswal Financial Services Limited', 'MPHASIS': 'MphasiS Limited', 'MRF': 'MRF Limited', 'MRPL': 'Mangalore Refinery and Petrochemicals Limited', 'MUTHOOTFIN': 'Muthoot Finance Limited', 'NAM-INDIA': 'Nippon Life India Asset Management Limited', 'NATCOPHARM': 'Natco Pharma Limited', 'NATIONALUM': 'National Aluminium Company Limited', 'NAUKRI': 'Info Edge (India) Limited', 'NAVINFLUOR': 'Navin Fluorine International Limited', 'NBCC': 'NBCC (India) Limited', 'NCC': 'NCC Limited', 'NESCO': 'Nesco Limited', 'NESTLEIND': 'Nestle India Limited', 'NETWORK18': 'Network18 Media & Investments Limited', 'NFL': 'National Fertilizers Limited', 'NH': 'Narayana Hrudayalaya Ltd.', 'NHPC': 'NHPC Limited', 'NIACL': 'The New India Assurance Company Limited', 'NILKAMAL': 'Nilkamal Limited', 'NLCINDIA': 'NLC India Limited', 'NMDC': 'NMDC Limited', 'NOCIL': 'NOCIL Limited', 'NTPC': 'NTPC Limited', 'OBEROIRLTY': 'Oberoi Realty Limited', 'OFSS': 'Oracle Financial Services Software Limited', 'OIL': 'Oil India Limited', 'ONGC': 'Oil & Natural Gas Corporation Limited', 'ORIENTELEC': 'Orient Electric Limited', 'ORIENTREF': 'Orient Refractories Limited', 'PAGEIND': 'Page Industries Limited', 'PEL': 'Piramal Enterprises Limited', 'PERSISTENT': 'Persistent Systems Limited', 'PETRONET': 'Petronet LNG Limited', 'PFC': 'Power Finance Corporation Limited', 'PFIZER': 'Pfizer Limited', 'PGHH': 'Procter & Gamble Hygiene and Health Care Limited', 'PGHL': 'Procter & Gamble Health Limited', 'PHILIPCARB': 'Phillips Carbon Black Limited', 'PHOENIXLTD': 'The Phoenix Mills Limited', 'PIDILITIND': 'Pidilite Industries Limited', 'PIIND': 'PI Industries Limited', 'PNB': 'Punjab National Bank', 'PNBHOUSING': 'PNB Housing Finance Limited', 'PNCINFRA': 'PNC Infratech Limited', 'POLYCAB': 'Polycab India Limited', 'POLYMED': 'Poly Medicure Limited', 'POLYPLEX': 'Polyplex Corporation Limited', 'POWERGRID': 'Power Grid Corporation of India Limited', 'POWERINDIA': 'ABB Power Products and Systems India Limited', 'PRESTIGE': 'Prestige Estates Projects Limited', 'PRINCEPIPE': 'Prince Pipes And Fittings Limited', 'PRSMJOHNSN': 'Prism Johnson Limited', 'PVR': 'PVR Limited', 'QUESS': 'Quess Corp Limited', 'RADICO': 'Radico Khaitan Limited', 'RAIN': 'Rain Industries Limited', 'RAJESHEXPO': 'Rajesh Exports Limited', 'RALLIS': 'Rallis India Limited', 'RAMCOCEM': 'The Ramco Cements Limited', 'RATNAMANI': 'Ratnamani Metals & Tubes Limited', 'RAYMOND': 'Raymond Limited', 'RBLBANK': 'RBL Bank Limited', 'RCF': 'Rashtriya Chemicals and Fertilizers Limited', 'RECLTD': 'REC Limited', 'REDINGTON': 'Redington (India) Limited', 'RELAXO': 'Relaxo Footwears Limited', 'RELIANCE': 'Reliance Industries Limited', 'RESPONIND': 'Responsive Industries Limited', 'RITES': 'RITES Limited', 'ROSSARI': 'Rossari Biotech Limited', 'ROUTE': 'ROUTE MOBILE LIMITED', 'RVNL': 'Rail Vikas Nigam Limited', 'SAIL': 'Steel Authority of India Limited', 'SANOFI': 'Sanofi India Limited', 'SBICARD': 'SBI Cards and Payment Services Limited', 'SBILIFE': 'SBI Life Insurance Company Limited', 'SBIN': 'State Bank of India', 'SCHAEFFLER': 'Schaeffler India Limited', 'SCHNEIDER': 'Schneider Electric Infrastructure Limited', 'SCI': 'Shipping Corporation Of India Limited', 'SEQUENT': 'Sequent Scientific Limited', 'SFL': 'Sheela Foam Limited', 'SHARDACROP': 'Sharda Cropchem Limited', 'SHILPAMED': 'Shilpa Medicare Limited', 'SHOPERSTOP': 'Shoppers Stop Limited', 'SHREECEM': 'SHREE CEMENT LIMITED', 'SHRIRAMCIT': 'Shriram City Union Finance Limited', 'SIEMENS': 'Siemens Limited', 'SIS': 'SIS LIMITED', 'SJVN': 'SJVN Limited', 'SKFINDIA': 'SKF India Limited', 'SOBHA': 'Sobha Limited', 'SOLARA': 'Solara Active Pharma Sciences Limited', 'SOLARINDS': 'Solar Industries India Limited', 'SONATSOFTW': 'Sonata Software Limited', 'SPANDANA': 'Spandana Sphoorty Financial Limited', 'SPARC': 'Sun Pharma Advanced Research Company Limited', 'SPICEJET': 'SPICEJET LTD', 'SRF': 'SRF Limited', 'SRTRANSFIN': 'Shriram Transport Finance Company Limited', 'STAR': 'Strides Pharma Science Limited', 'STARCEMENT': 'Star Cement Limited', 'STLTECH': 'Sterlite Technologies Limited', 'SUDARSCHEM': 'Sudarshan Chemical Industries Limited', 'SUMICHEM': 'Sumitomo Chemical India Limited', 'SUNCLAYLTD': 'Sundaram Clayton Limited', 'SUNDARMFIN': 'Sundaram Finance Limited', 'SUNDRMFAST': 'Sundram Fasteners Limited', 'SUNPHARMA': 'Sun Pharmaceutical Industries Limited', 'SUNTECK': 'Sunteck Realty Limited', 'SUNTV': 'Sun TV Network Limited', 'SUPPETRO': 'Supreme Petrochem Limited', 'SUPRAJIT': 'Suprajit Engineering Limited', 'SUPREMEIND': 'Supreme Industries Limited', 'SUVENPHAR': 'Suven Pharmaceuticals Limited', 'SUZLON': 'Suzlon Energy Limited', 'SWANENERGY': 'Swan Energy Limited', 'SWSOLAR': 'Sterling And Wilson Solar Limited', 'SYMPHONY': 'Symphony Limited', 'SYNGENE': 'Syngene International Limited', 'TANLA': 'Tanla Platforms Limited', 'TASTYBITE': 'Tasty Bite Eatables Limited', 'TATACHEM': 'Tata Chemicals Limited', 'TATACOFFEE': 'Tata Coffee Limited', 'TATACOMM': 'Tata Communications Limited', 'TATACONSUM': 'TATA CONSUMER PRODUCTS LIMITED', 'TATAELXSI': 'Tata Elxsi Limited', 'TATAINVEST': 'Tata Investment Corporation Limited', 'TATAMOTORS': 'Tata Motors Limited', 'TATAMTRDVR': 'Tata Motors Limited', 'TATAPOWER': 'Tata Power Company Limited', 'TATASTEEL': 'Tata Steel Limited', 'TCIEXP': 'TCI Express Limited', 'TCNSBRANDS': 'TCNS Clothing Co. Limited', 'TCS': 'Tata Consultancy Services Limited', 'TEAMLEASE': 'Teamlease Services Limited', 'TECHM': 'Tech Mahindra Limited', 'THERMAX': 'Thermax Limited', 'THYROCARE': 'Thyrocare Technologies Limited', 'TIINDIA': 'Tube Investments of India Limited', 'TIMKEN': 'Timken India Limited', 'TITAN': 'Titan Company Limited', 'TORNTPHARM': 'Torrent Pharmaceuticals Limited', 'TORNTPOWER': 'Torrent Power Limited', 'TRENT': 'Trent Limited', 'TRIDENT': 'Trident Limited', 'TRITURBINE': 'Triveni Turbine Limited', 'TTKPRESTIG': 'TTK Prestige Limited', 'TV18BRDCST': 'TV18 Broadcast Limited', 'TVSMOTOR': 'TVS Motor Company Limited', 'UBL': 'United Breweries Limited', 'UCOBANK': 'UCO Bank', 'UFLEX': 'UFLEX Limited', 'UJJIVAN': 'Ujjivan Financial Services Limited', 'UJJIVANSFB': 'Ujjivan Small Finance Bank Limited', 'ULTRACEMCO': 'UltraTech Cement Limited', 'UNIONBANK': 'Union Bank of India', 'UPL': 'UPL Limited', 'UTIAMC': 'UTI Asset Management Company Limited', 'VAIBHAVGBL': 'Vaibhav Global Limited', 'VAKRANGEE': 'Vakrangee Limited', 'VALIANTORG': 'Valiant Organics Limited', 'VARROC': 'Varroc Engineering Limited', 'VBL': 'Varun Beverages Limited', 'VEDL': 'Vedanta Limited', 'VENKEYS': "Venky's (India) Limited", 'VGUARD': 'V-Guard Industries Limited', 'VINATIORGA': 'Vinati Organics Limited', 'VIPIND': 'VIP Industries Limited', 'VMART': 'V-Mart Retail Limited', 'VOLTAS': 'Voltas Limited', 'VSTIND': 'VST Industries Limited', 'VTL': 'Vardhman Textiles Limited', 'WABCOINDIA': 'WABCO India Limited', 'WELCORP': 'Welspun Corp Limited', 'WELSPUNIND': 'Welspun India Limited', 'WESTLIFE': 'Westlife Development Ltd', 'WHIRLPOOL': 'Whirlpool of India Limited', 'WIPRO': 'Wipro Limited', 'WOCKPHARMA': 'Wockhardt Limited', 'YESBANK': 'Yes Bank Limited', 'ZEEL': 'Zee Entertainment Enterprises Limited', 'ZENSARTECH': 'Zensar Technologies Limited', 'ZYDUSWELL': 'Zydus Wellness Limited'}
d500_re={'3M India Limited': '3MINDIA', 'Aarti Drugs Limited': 'AARTIDRUGS', 'Aarti Industries Limited': 'AARTIIND', 'Aavas Financiers Limited': 'AAVAS', 'ABB India Limited': 'ABB', 'Abbott India Limited': 'ABBOTINDIA', 'Aditya Birla Capital Limited': 'ABCAPITAL', 'Aditya Birla Fashion and Retail Limited': 'ABFRL', 'ACC Limited': 'ACC', 'Adani Enterprises Limited': 'ADANIENT', 'Adani Green Energy Limited': 'ADANIGREEN', 'Adani Ports and Special Economic Zone Limited': 'ADANIPORTS', 'Adani Transmission Limited': 'ADANITRANS', 'Advanced Enzyme Technologies Limited': 'ADVENZYMES', 'Aegis Logistics Limited': 'AEGISCHEM', 'Affle (India) Limited': 'AFFLE', 'AIA Engineering Limited': 'AIAENG', 'Ajanta Pharma Limited': 'AJANTPHARM', 'Akzo Nobel India Limited': 'AKZOINDIA', 'Alembic Limited': 'ALEMBICLTD', 'Alkem Laboratories Limited': 'ALKEM', 'Alkyl Amines Chemicals Limited': 'ALKYLAMINE', 'Alok Industries Limited': 'ALOKINDS', 'Amara Raja Batteries Limited': 'AMARAJABAT', 'Amber Enterprises India Limited': 'AMBER', 'Ambuja Cements Limited': 'AMBUJACEM', 'Angel Broking Limited': 'ANGELBRKG', 'APL Apollo Tubes Limited': 'APLAPOLLO', 'Alembic Pharmaceuticals Limited': 'APLLTD', 'Apollo Hospitals Enterprise Limited': 'APOLLOHOSP', 'Apollo Tyres Limited': 'APOLLOTYRE', 'Asahi India Glass Limited': 'ASAHIINDIA', 'Ashoka Buildcon Limited': 'ASHOKA', 'Ashok Leyland Limited': 'ASHOKLEY', 'Asian Paints Limited': 'ASIANPAINT', 'Aster DM Healthcare Limited': 'ASTERDM', 'Astral Poly Technik Limited': 'ASTRAL', 'AstraZeneca Pharma India Limited': 'ASTRAZEN', 'Adani Total Gas Limited': 'ATGL', 'Atul Limited': 'ATUL', 'AU Small Finance Bank Limited': 'AUBANK', 'Aurobindo Pharma Limited': 'AUROPHARMA', 'Avanti Feeds Limited': 'AVANTIFEED', 'Axis Bank Limited': 'AXISBANK', 'Bajaj Auto Limited': 'BAJAJ-AUTO', 'Bajaj Consumer Care Limited': 'BAJAJCON', 'Bajaj Electricals Limited': 'BAJAJELEC', 'Bajaj Finserv Limited': 'BAJAJFINSV', 'Bajaj Holdings & Investment Limited': 'BAJAJHLDNG', 'Bajaj Finance Limited': 'BAJFINANCE', 'Balaji Amines Limited': 'BALAMINES', 'Balkrishna Industries Limited': 'BALKRISIND', 'Balmer Lawrie & Company Limited': 'BALMLAWRIE', 'Balrampur Chini Mills Limited': 'BALRAMCHIN', 'Bandhan Bank Limited': 'BANDHANBNK', 'Bank of Baroda': 'BANKBARODA', 'Bank of India': 'BANKINDIA', 'BASF India Limited': 'BASF', 'Bata India Limited': 'BATAINDIA', 'Bayer Cropscience Limited': 'BAYERCROP', 'Bombay Burmah Trading Corporation Limited': 'BBTC', 'Bharat Dynamics Limited': 'BDL', 'Bharat Electronics Limited': 'BEL', 'BEML Limited': 'BEML', 'Berger Paints (I) Limited': 'BERGEPAINT', 'Bharat Forge Limited': 'BHARATFORG', 'Bharat Rasayan Limited': 'BHARATRAS', 'Bharti Airtel Limited': 'BHARTIARTL', 'Bharat Heavy Electricals Limited': 'BHEL', 'Biocon Limited': 'BIOCON', 'Birla Corporation Limited': 'BIRLACORPN', 'Bliss GVS Pharma Limited': 'BLISSGVS', 'Blue Dart Express Limited': 'BLUEDART', 'Blue Star Limited': 'BLUESTARCO', 'Bosch Limited': 'BOSCHLTD', 'Bharat Petroleum Corporation Limited': 'BPCL', 'Brigade Enterprises Limited': 'BRIGADE', 'Britannia Industries Limited': 'BRITANNIA', 'BSE Limited': 'BSE', 'BIRLASOFT LIMITED': 'BSOFT', 'Burger King India Limited': 'BURGERKING', 'Cadila Healthcare Limited': 'CADILAHC', 'Computer Age Management Services Limited': 'CAMS', 'Canara Bank': 'CANBK', 'Can Fin Homes Limited': 'CANFINHOME', 'Caplin Point Laboratories Limited': 'CAPLIPOINT', 'Carborundum Universal Limited': 'CARBORUNIV', 'Castrol India Limited': 'CASTROLIND', 'CCL Products (India) Limited': 'CCL', 'Central Depository Services (India) Limited': 'CDSL', 'CEAT Limited': 'CEATLTD', 'Central Bank of India': 'CENTRALBK', 'Century Plyboards (India) Limited': 'CENTURYPLY', 'Century Textiles & Industries Limited': 'CENTURYTEX', 'Cera Sanitaryware Limited': 'CERA', 'CESC Limited': 'CESC', 'Capri Global Capital Limited': 'CGCL', 'Chalet Hotels Limited': 'CHALET', 'Chambal Fertilizers & Chemicals Limited': 'CHAMBLFERT', 'Cholamandalam Investment and Finance Company Limited': 'CHOLAFIN', 'Cholamandalam Financial Holdings Limited': 'CHOLAHLDNG', 'Cipla Limited': 'CIPLA', 'Coal India Limited': 'COALINDIA', 'Cochin Shipyard Limited': 'COCHINSHIP', 'Coforge Limited': 'COFORGE', 'Colgate Palmolive (India) Limited': 'COLPAL', 'Container Corporation of India Limited': 'CONCOR', 'Coromandel International Limited': 'COROMANDEL', 'CREDITACCESS GRAMEEN LIMITED': 'CREDITACC', 'CRISIL Limited': 'CRISIL', 'Crompton Greaves Consumer Electricals Limited': 'CROMPTON', 'CSB Bank Limited': 'CSBBANK', 'City Union Bank Limited': 'CUB', 'Cummins India Limited': 'CUMMINSIND', 'Cyient Limited': 'CYIENT', 'Dabur India Limited': 'DABUR', 'Dalmia Bharat Limited': 'DALBHARAT', 'Dilip Buildcon Limited': 'DBL', 'Dishman Carbogen Amcis Limited': 'DCAL', 'DCB Bank Limited': 'DCBBANK', 'DCM Shriram Limited': 'DCMSHRIRAM', 'Deepak Nitrite Limited': 'DEEPAKNTR', 'Delta Corp Limited': 'DELTACORP', 'Dhani Services Limited': 'DHANI', 'Dhanuka Agritech Limited': 'DHANUKA', 'Dish TV India Limited': 'DISHTV', "Divi's Laboratories Limited": 'DIVISLAB', 'Dixon Technologies (India) Limited': 'DIXON', 'DLF Limited': 'DLF', 'Avenue Supermarts Limited': 'DMART', "Dr. Reddy's Laboratories Limited": 'DRREDDY', 'eClerx Services Limited': 'ECLERX', 'Edelweiss Financial Services Limited': 'EDELWEISS', 'Eicher Motors Limited': 'EICHERMOT', 'EID Parry India Limited': 'EIDPARRY', 'EIH Limited': 'EIHOTEL', 'Elgi Equipments Limited': 'ELGIEQUIP', 'Emami Limited': 'EMAMILTD', 'Endurance Technologies Limited': 'ENDURANCE', 'Engineers India Limited': 'ENGINERSIN', 'EPL Limited': 'EPL', 'Equitas Holdings Limited': 'EQUITAS', 'Eris Lifesciences Limited': 'ERIS', 'Escorts Limited': 'ESCORTS', 'Exide Industries Limited': 'EXIDEIND', 'Future Consumer Limited': 'FCONSUMER', 'FDC Limited': 'FDC', 'The Federal Bank  Limited': 'FEDERALBNK', 'Finolex Cables Limited': 'FINCABLES', 'Fine Organic Industries Limited': 'FINEORG', 'Finolex Industries Limited': 'FINPIPE', 'Gujarat Fluorochemicals Limited': 'FLUOROCHEM', 'Fortis Healthcare Limited': 'FORTIS', 'Future Retail Limited': 'FRETAIL', 'Firstsource Solutions Limited': 'FSL', 'Gujarat Ambuja Exports Limited': 'GAEL', 'GAIL (India) Limited': 'GAIL', 'Galaxy Surfactants Limited': 'GALAXYSURF', 'Garware Technical Fibres Limited': 'GARFIBRES', 'GE Power India Limited': 'GEPIL', 'The Great Eastern Shipping Company Limited': 'GESHIP', 'General Insurance Corporation of India': 'GICRE', 'Gillette India Limited': 'GILLETTE', 'GlaxoSmithKline Pharmaceuticals Limited': 'GLAXO', 'Glenmark Pharmaceuticals Limited': 'GLENMARK', 'GMM Pfaudler Limited': 'GMMPFAUDLR', 'GMR Infrastructure Limited': 'GMRINFRA', 'Gujarat Narmada Valley Fertilizers and Chemicals Limited': 'GNFC', 'Godfrey Phillips India Limited': 'GODFRYPHLP', 'Godrej Agrovet Limited': 'GODREJAGRO', 'Godrej Consumer Products Limited': 'GODREJCP', 'Godrej Industries Limited': 'GODREJIND', 'Godrej Properties Limited': 'GODREJPROP', 'Gujarat Pipavav Port Limited': 'GPPL', 'Granules India Limited': 'GRANULES', 'Graphite India Limited': 'GRAPHITE', 'Grasim Industries Limited': 'GRASIM', 'Greaves Cotton Limited': 'GREAVESCOT', 'Grindwell Norton Limited': 'GRINDWELL', 'Garden Reach Shipbuilders & Engineers Limited': 'GRSE', 'Gujarat State Fertilizers & Chemicals Limited': 'GSFC', 'Gujarat State Petronet Limited': 'GSPL', 'Gujarat Alkalies and Chemicals Limited': 'GUJALKALI', 'Gujarat Gas Limited': 'GUJGASLTD', 'Gulf Oil Lubricants India Limited': 'GULFOILLUB', 'Hindustan Aeronautics Limited': 'HAL', 'Happiest Minds Technologies Limited': 'HAPPSTMNDS', 'Hatsun Agro Product Limited': 'HATSUN', 'Havells India Limited': 'HAVELLS', 'HCL Technologies Limited': 'HCLTECH', 'Housing Development Finance Corporation Limited': 'HDFC', 'HDFC Asset Management Company Limited': 'HDFCAMC', 'HDFC Bank Limited': 'HDFCBANK', 'HDFC Life Insurance Company Limited': 'HDFCLIFE', 'HEG Limited': 'HEG', 'HeidelbergCement India Limited': 'HEIDELBERG', 'Hemisphere Properties India Limited': 'HEMIPROP', 'Hero MotoCorp Limited': 'HEROMOTOCO', 'HFCL Limited': 'HFCL', 'Hindalco Industries Limited': 'HINDALCO', 'Hindustan Copper Limited': 'HINDCOPPER', 'Hindustan Petroleum Corporation Limited': 'HINDPETRO', 'Hindustan Unilever Limited': 'HINDUNILVR', 'Hindustan Zinc Limited': 'HINDZINC', 'Honeywell Automation India Limited': 'HONAUT', 'Himadri Speciality Chemical Limited': 'HSCL', 'Housing & Urban Development Corporation Limited': 'HUDCO', 'Huhtamaki India Limited': 'HUHTAMAKI', 'Indiabulls Real Estate Limited': 'IBREALEST', 'Indiabulls Housing Finance Limited': 'IBULHSGFIN', 'ICICI Bank Limited': 'ICICIBANK', 'ICICI Lombard General Insurance Company Limited': 'ICICIGI', 'ICICI Prudential Life Insurance Company Limited': 'ICICIPRULI', 'Indo Count Industries Limited': 'ICIL', 'IDBI Bank Limited': 'IDBI', 'Vodafone Idea Limited': 'IDEA', 'IDFC Limited': 'IDFC', 'IDFC First Bank Limited': 'IDFCFIRSTB', 'Indian Energy Exchange Limited': 'IEX', 'IFB Industries Limited': 'IFBIND', 'Indraprastha Gas Limited': 'IGL', 'IIFL Finance Limited': 'IIFL', 'Iifl Wealth Management Limited': 'IIFLWAM', 'The Indian Hotels Company Limited': 'INDHOTEL', 'The India Cements Limited': 'INDIACEM', 'Indiamart Intermesh Limited': 'INDIAMART', 'Indian Bank': 'INDIANB', 'InterGlobe Aviation Limited': 'INDIGO', 'Indoco Remedies Limited': 'INDOCO', 'IndusInd Bank Limited': 'INDUSINDBK', 'Indus Towers Limited': 'INDUSTOWER', 'Infibeam Avenues Limited': 'INFIBEAM', 'Infosys Limited': 'INFY', 'Ingersoll Rand (India) Limited': 'INGERRAND', 'INOX Leisure Limited': 'INOXLEISUR', 'Intellect Design Arena Limited': 'INTELLECT', 'Indian Overseas Bank': 'IOB', 'Indian Oil Corporation Limited': 'IOC', 'IOL Chemicals and Pharmaceuticals Limited': 'IOLCP', 'IPCA Laboratories Limited': 'IPCALAB', 'IRB Infrastructure Developers Limited': 'IRB', 'Ircon International Limited': 'IRCON', 'Indian Railway Catering And Tourism Corporation Limited': 'IRCTC', 'ICICI Securities Limited': 'ISEC', 'ITC Limited': 'ITC', 'ITI Limited': 'ITI', 'Jamna Auto Industries Limited': 'JAMNAAUTO', 'JB Chemicals & Pharmaceuticals Limited': 'JBCHEPHARM', 'Johnson Controls - Hitachi Air Conditioning India Limited': 'JCHAC', 'Jindal Saw Limited': 'JINDALSAW', 'Jindal Steel & Power Limited': 'JINDALSTEL', 'JK Cement Limited': 'JKCEMENT', 'JK Lakshmi Cement Limited': 'JKLAKSHMI', 'JK Paper Limited': 'JKPAPER', 'JK Tyre & Industries Limited': 'JKTYRE', 'JM Financial Limited': 'JMFINANCIL', 'Jindal Stainless Limited': 'JSL', 'Jindal Stainless (Hisar) Limited': 'JSLHISAR', 'JSW Energy Limited': 'JSWENERGY', 'JSW Steel Limited': 'JSWSTEEL', 'Jtekt India Limited': 'JTEKTINDIA', 'Jubilant Foodworks Limited': 'JUBLFOOD', 'Just Dial Limited': 'JUSTDIAL', 'Jyothy Labs Limited': 'JYOTHYLAB', 'Kajaria Ceramics Limited': 'KAJARIACER', 'Kalpataru Power Transmission Limited': 'KALPATPOWR', 'Kansai Nerolac Paints Limited': 'KANSAINER', 'Karur Vysya Bank Limited': 'KARURVYSYA', 'KEC International Limited': 'KEC', 'KEI Industries Limited': 'KEI', 'KNR Constructions Limited': 'KNRCON', 'Kotak Mahindra Bank Limited': 'KOTAKBANK', 'KPIT Technologies Limited': 'KPITTECH', 'K.P.R. Mill Limited': 'KPRMILL', 'KRBL Limited': 'KRBL', 'Ksb Limited': 'KSB', 'Kaveri Seed Company Limited': 'KSCL', 'L&T Finance Holdings Limited': 'L&TFH', 'Dr. Lal Path Labs Ltd.': 'LALPATHLAB', 'La Opala RG Limited': 'LAOPALA', 'Laurus Labs Limited': 'LAURUSLABS', 'Lakshmi Machine Works Limited': 'LAXMIMACH', 'Lemon Tree Hotels Limited': 'LEMONTREE', 'LIC Housing Finance Limited': 'LICHSGFIN', 'Linde India Limited': 'LINDEINDIA', 'Larsen & Toubro Limited': 'LT', 'Larsen & Toubro Infotech Limited': 'LTI', 'L&T Technology Services Limited': 'LTTS', 'Lupin Limited': 'LUPIN', 'Lux Industries Limited': 'LUXIND', 'Mahindra & Mahindra Limited': 'M&M', 'Mahindra & Mahindra Financial Services Limited': 'M&MFIN', 'Bank of Maharashtra': 'MAHABANK', 'Mahindra CIE Automotive Limited': 'MAHINDCIE', 'Mahindra Logistics Limited': 'MAHLOG', 'Maharashtra Scooters Limited': 'MAHSCOOTER', 'Maharashtra Seamless Limited': 'MAHSEAMLES', 'Manappuram Finance Limited': 'MANAPPURAM', 'Marico Limited': 'MARICO', 'Maruti Suzuki India Limited': 'MARUTI', 'MAS Financial Services Limited': 'MASFIN', 'Max Healthcare Institute Limited': 'MAXHEALTH', 'Mazagon Dock Shipbuilders Limited': 'MAZDOCK', 'United Spirits Limited': 'MCDOWELL-N', 'Multi Commodity Exchange of India Limited': 'MCX', 'Metropolis Healthcare Limited': 'METROPOLIS', 'Max Financial Services Limited': 'MFSL', 'Mahanagar Gas Limited': 'MGL', 'Mahindra Holidays & Resorts India Limited': 'MHRIL', 'Mishra Dhatu Nigam Limited': 'MIDHANI', 'Minda Corporation Limited': 'MINDACORP', 'Minda Industries Limited': 'MINDAIND', 'MindTree Limited': 'MINDTREE', 'MMTC Limited': 'MMTC', 'MOIL Limited': 'MOIL', 'Motherson Sumi Systems Limited': 'MOTHERSUMI', 'Motilal Oswal Financial Services Limited': 'MOTILALOFS', 'MphasiS Limited': 'MPHASIS', 'MRF Limited': 'MRF', 'Mangalore Refinery and Petrochemicals Limited': 'MRPL', 'Muthoot Finance Limited': 'MUTHOOTFIN', 'Nippon Life India Asset Management Limited': 'NAM-INDIA', 'Natco Pharma Limited': 'NATCOPHARM', 'National Aluminium Company Limited': 'NATIONALUM', 'Info Edge (India) Limited': 'NAUKRI', 'Navin Fluorine International Limited': 'NAVINFLUOR', 'NBCC (India) Limited': 'NBCC', 'NCC Limited': 'NCC', 'Nesco Limited': 'NESCO', 'Nestle India Limited': 'NESTLEIND', 'Network18 Media & Investments Limited': 'NETWORK18', 'National Fertilizers Limited': 'NFL', 'Narayana Hrudayalaya Ltd.': 'NH', 'NHPC Limited': 'NHPC', 'The New India Assurance Company Limited': 'NIACL', 'Nilkamal Limited': 'NILKAMAL', 'NLC India Limited': 'NLCINDIA', 'NMDC Limited': 'NMDC', 'NOCIL Limited': 'NOCIL', 'NTPC Limited': 'NTPC', 'Oberoi Realty Limited': 'OBEROIRLTY', 'Oracle Financial Services Software Limited': 'OFSS', 'Oil India Limited': 'OIL', 'Oil & Natural Gas Corporation Limited': 'ONGC', 'Orient Electric Limited': 'ORIENTELEC', 'Orient Refractories Limited': 'ORIENTREF', 'Page Industries Limited': 'PAGEIND', 'Piramal Enterprises Limited': 'PEL', 'Persistent Systems Limited': 'PERSISTENT', 'Petronet LNG Limited': 'PETRONET', 'Power Finance Corporation Limited': 'PFC', 'Pfizer Limited': 'PFIZER', 'Procter & Gamble Hygiene and Health Care Limited': 'PGHH', 'Procter & Gamble Health Limited': 'PGHL', 'Phillips Carbon Black Limited': 'PHILIPCARB', 'The Phoenix Mills Limited': 'PHOENIXLTD', 'Pidilite Industries Limited': 'PIDILITIND', 'PI Industries Limited': 'PIIND', 'Punjab National Bank': 'PNB', 'PNB Housing Finance Limited': 'PNBHOUSING', 'PNC Infratech Limited': 'PNCINFRA', 'Polycab India Limited': 'POLYCAB', 'Poly Medicure Limited': 'POLYMED', 'Polyplex Corporation Limited': 'POLYPLEX', 'Power Grid Corporation of India Limited': 'POWERGRID', 'ABB Power Products and Systems India Limited': 'POWERINDIA', 'Prestige Estates Projects Limited': 'PRESTIGE', 'Prince Pipes And Fittings Limited': 'PRINCEPIPE', 'Prism Johnson Limited': 'PRSMJOHNSN', 'PVR Limited': 'PVR', 'Quess Corp Limited': 'QUESS', 'Radico Khaitan Limited': 'RADICO', 'Rain Industries Limited': 'RAIN', 'Rajesh Exports Limited': 'RAJESHEXPO', 'Rallis India Limited': 'RALLIS', 'The Ramco Cements Limited': 'RAMCOCEM', 'Ratnamani Metals & Tubes Limited': 'RATNAMANI', 'Raymond Limited': 'RAYMOND', 'RBL Bank Limited': 'RBLBANK', 'Rashtriya Chemicals and Fertilizers Limited': 'RCF', 'REC Limited': 'RECLTD', 'Redington (India) Limited': 'REDINGTON', 'Relaxo Footwears Limited': 'RELAXO', 'Reliance Industries Limited': 'RELIANCE', 'Responsive Industries Limited': 'RESPONIND', 'RITES Limited': 'RITES', 'Rossari Biotech Limited': 'ROSSARI', 'ROUTE MOBILE LIMITED': 'ROUTE', 'Rail Vikas Nigam Limited': 'RVNL', 'Steel Authority of India Limited': 'SAIL', 'Sanofi India Limited': 'SANOFI', 'SBI Cards and Payment Services Limited': 'SBICARD', 'SBI Life Insurance Company Limited': 'SBILIFE', 'State Bank of India': 'SBIN', 'Schaeffler India Limited': 'SCHAEFFLER', 'Schneider Electric Infrastructure Limited': 'SCHNEIDER', 'Shipping Corporation Of India Limited': 'SCI', 'Sequent Scientific Limited': 'SEQUENT', 'Sheela Foam Limited': 'SFL', 'Sharda Cropchem Limited': 'SHARDACROP', 'Shilpa Medicare Limited': 'SHILPAMED', 'Shoppers Stop Limited': 'SHOPERSTOP', 'SHREE CEMENT LIMITED': 'SHREECEM', 'Shriram City Union Finance Limited': 'SHRIRAMCIT', 'Siemens Limited': 'SIEMENS', 'SIS LIMITED': 'SIS', 'SJVN Limited': 'SJVN', 'SKF India Limited': 'SKFINDIA', 'Sobha Limited': 'SOBHA', 'Solara Active Pharma Sciences Limited': 'SOLARA', 'Solar Industries India Limited': 'SOLARINDS', 'Sonata Software Limited': 'SONATSOFTW', 'Spandana Sphoorty Financial Limited': 'SPANDANA', 'Sun Pharma Advanced Research Company Limited': 'SPARC', 'SPICEJET LTD': 'SPICEJET', 'SRF Limited': 'SRF', 'Shriram Transport Finance Company Limited': 'SRTRANSFIN', 'Strides Pharma Science Limited': 'STAR', 'Star Cement Limited': 'STARCEMENT', 'Sterlite Technologies Limited': 'STLTECH', 'Sudarshan Chemical Industries Limited': 'SUDARSCHEM', 'Sumitomo Chemical India Limited': 'SUMICHEM', 'Sundaram Clayton Limited': 'SUNCLAYLTD', 'Sundaram Finance Limited': 'SUNDARMFIN', 'Sundram Fasteners Limited': 'SUNDRMFAST', 'Sun Pharmaceutical Industries Limited': 'SUNPHARMA', 'Sunteck Realty Limited': 'SUNTECK', 'Sun TV Network Limited': 'SUNTV', 'Supreme Petrochem Limited': 'SUPPETRO', 'Suprajit Engineering Limited': 'SUPRAJIT', 'Supreme Industries Limited': 'SUPREMEIND', 'Suven Pharmaceuticals Limited': 'SUVENPHAR', 'Suzlon Energy Limited': 'SUZLON', 'Swan Energy Limited': 'SWANENERGY', 'Sterling And Wilson Solar Limited': 'SWSOLAR', 'Symphony Limited': 'SYMPHONY', 'Syngene International Limited': 'SYNGENE', 'Tanla Platforms Limited': 'TANLA', 'Tasty Bite Eatables Limited': 'TASTYBITE', 'Tata Chemicals Limited': 'TATACHEM', 'Tata Coffee Limited': 'TATACOFFEE', 'Tata Communications Limited': 'TATACOMM', 'TATA CONSUMER PRODUCTS LIMITED': 'TATACONSUM', 'Tata Elxsi Limited': 'TATAELXSI', 'Tata Investment Corporation Limited': 'TATAINVEST', 'Tata Motors Limited': 'TATAMTRDVR', 'Tata Power Company Limited': 'TATAPOWER', 'Tata Steel Limited': 'TATASTEEL', 'TCI Express Limited': 'TCIEXP', 'TCNS Clothing Co. Limited': 'TCNSBRANDS', 'Tata Consultancy Services Limited': 'TCS', 'Teamlease Services Limited': 'TEAMLEASE', 'Tech Mahindra Limited': 'TECHM', 'Thermax Limited': 'THERMAX', 'Thyrocare Technologies Limited': 'THYROCARE', 'Tube Investments of India Limited': 'TIINDIA', 'Timken India Limited': 'TIMKEN', 'Titan Company Limited': 'TITAN', 'Torrent Pharmaceuticals Limited': 'TORNTPHARM', 'Torrent Power Limited': 'TORNTPOWER', 'Trent Limited': 'TRENT', 'Trident Limited': 'TRIDENT', 'Triveni Turbine Limited': 'TRITURBINE', 'TTK Prestige Limited': 'TTKPRESTIG', 'TV18 Broadcast Limited': 'TV18BRDCST', 'TVS Motor Company Limited': 'TVSMOTOR', 'United Breweries Limited': 'UBL', 'UCO Bank': 'UCOBANK', 'UFLEX Limited': 'UFLEX', 'Ujjivan Financial Services Limited': 'UJJIVAN', 'Ujjivan Small Finance Bank Limited': 'UJJIVANSFB', 'UltraTech Cement Limited': 'ULTRACEMCO', 'Union Bank of India': 'UNIONBANK', 'UPL Limited': 'UPL', 'UTI Asset Management Company Limited': 'UTIAMC', 'Vaibhav Global Limited': 'VAIBHAVGBL', 'Vakrangee Limited': 'VAKRANGEE', 'Valiant Organics Limited': 'VALIANTORG', 'Varroc Engineering Limited': 'VARROC', 'Varun Beverages Limited': 'VBL', 'Vedanta Limited': 'VEDL', "Venky's (India) Limited": 'VENKEYS', 'V-Guard Industries Limited': 'VGUARD', 'Vinati Organics Limited': 'VINATIORGA', 'VIP Industries Limited': 'VIPIND', 'V-Mart Retail Limited': 'VMART', 'Voltas Limited': 'VOLTAS', 'VST Industries Limited': 'VSTIND', 'Vardhman Textiles Limited': 'VTL', 'WABCO India Limited': 'WABCOINDIA', 'Welspun Corp Limited': 'WELCORP', 'Welspun India Limited': 'WELSPUNIND', 'Westlife Development Ltd': 'WESTLIFE', 'Whirlpool of India Limited': 'WHIRLPOOL', 'Wipro Limited': 'WIPRO', 'Wockhardt Limited': 'WOCKPHARMA', 'Yes Bank Limited': 'YESBANK', 'Zee Entertainment Enterprises Limited': 'ZEEL', 'Zensar Technologies Limited': 'ZENSARTECH', 'Zydus Wellness Limited': 'ZYDUSWELL'}


def tf_idf(keys, dataframe, min_videos=1):
    tfidf_vectorizer = TfidfVectorizer()
    tfidf_matrix = tfidf_vectorizer.fit_transform(dataframe)

    query = tfidf_vectorizer.transform([keys])
    cs = cosine_similarity(query, tfidf_matrix)
    similarity_list = cs[0]
    result_list = []
    while min_videos > 0:
        tmp_index = np.argmax(similarity_list)
        result_list.append(tmp_index)
        similarity_list[tmp_index] = 0
        min_videos -= 1
        print(similarity_list)

    return result_list

dall=["WIPRO"]+list(d500.values())+list(d500.keys())
def ticker_match(y):
    x=tf_idf(y,dall,1)
    ans=dall[x[0]]
    if len(ans.split())>1:
        ans=d500_re[ans]
    return ans


def plot_elliot(df):
    dat,dat2=get_max_min(df,3,10)
    fig6 = px.line(df, x=df.index, y="Close", hover_data=["Close", "Volume", "Low", "High"], title="ADX trend")
    fig6.add_scatter(name="+ dmi", x=dat.index, y=dat)
    fig6.add_scatter(name="- dmi", x=dat2.index, y=dat2)
    fig6.show()

def get_max_min(prices, smoothing, window_range):
    smooth_prices = prices['Close'].rolling(window=smoothing).mean().dropna()
    local_max = argrelextrema(smooth_prices.values, np.greater)[0]
    local_min = argrelextrema(smooth_prices.values, np.less)[0]
    price_local_max_dt = []
    for i in local_max:
        if (i > window_range) and (i < len(prices) - window_range):
            price_local_max_dt.append(prices.iloc[i - window_range:i + window_range]['Close'].idxmax())
    price_local_min_dt = []
    for i in local_min:
        if (i > window_range) and (i < len(prices) - window_range):
            price_local_min_dt.append(prices.iloc[i - window_range:i + window_range]['Close'].idxmin())
    maxima = pd.DataFrame(prices.loc[price_local_max_dt])
    minima = pd.DataFrame(prices.loc[price_local_min_dt])

    max_min = pd.concat([maxima, minima]).sort_index()
    max_min = max_min[~max_min.index.duplicated()]

    px.scatter(max_min,x=max_min.index,y=max_min["Close"])
    return max_min

def find_patterns(max_min):
    patterns = defaultdict(list)

    for i in range(5, len(max_min)):
        window = max_min.iloc[i - 5:i]
        # Pattern must play out in less than n units
        if (window.index[-1] - window.index[0]).days > 100:
            continue
        a, b, c, d, e = window.iloc[0:5]["Close"]
        if a < b and c < a and c < e and c < d and e < d and abs(b - d) <= np.mean([b, d]) * 0.02:
            patterns['IHS'].append((window.index[0], window.index[-1]))
    return patterns


def plotit(patterns,max_min):
    fig = go.Scatter(x=max_min.index,y=max_min["Close"],line={'color': 'yellow'})
    data=[]
    return fig

def ichimoku(df):
    CL_period = 20  # length of Tenkan Sen or Conversion Line
    BL_period = 60  # length of Kijun Sen or Base Line
    Lead_span_B_period = 120  # length of Senkou Sen B or Leading Span B
    Lag_span_period = 30  # length of Chikou Span or Lagging Span
    # add to the dataframe, different components of the Ichimoku
    # use shift function to shift a time series forward by the given value
    df['Conv_line'] = (df.High.shift(CL_period) + df.Low.shift(CL_period)) / 2
    df['Base_line'] = (df.High.shift(BL_period) + df.Low.shift(BL_period)) / 2
    df['Lead_span_A'] = (df['Conv_line'] + df['Base_line']) / 2
    df['Lead_span_B'] = (df.High.shift(Lead_span_B_period) + df.Low.shift(Lead_span_B_period)) / 2
    df['Lagging_span'] = df.Close.shift(Lag_span_period)
    return df

def chart_squeeze(df,name=None):
    candlestick = go.Candlestick(x=df['Date'], open=df['Open'], high=df['High'], low=df['Low'], close=df['Close'])
    upper_band = go.Scatter(x=df['Date'], y=df['upper_band'], name='Upper Bollinger Band', line={'color': 'red'})
    lower_band = go.Scatter(x=df['Date'], y=df['lower_band'], name='Lower Bollinger Band', line={'color': 'red'})

    upper_keltner = go.Scatter(x=df['Date'], y=df['upper_keltner'], name='Upper Keltner Channel', line={'color': 'blue'})
    lower_keltner = go.Scatter(x=df['Date'], y=df['lower_keltner'], name='Lower Keltner Channel', line={'color': 'blue'})
    fiftysma = go.Scatter(x=df['Date'], y=df['fsma'], name='50 day sma',line={'color': 'brown'})
    tensma = go.Scatter(x=df['Date'], y=df['tsma'], name='10 day sma', line={'color': 'black'})

    close = go.Scatter(x=df['Date'], y=df['Close'], name='price',
                               line={'color': 'yellow'})
    fig = go.Figure(data=[candlestick, upper_band, lower_band, upper_keltner, lower_keltner,close,fiftysma,tensma])
    fig.layout.xaxis.type = 'category'
    fig.layout.xaxis.rangeslider.visible = True
    fig.update_layout(height=int(1000))
    return fig

def squeeze_chart(df,stock):
    df['20sma'] = df['Close'].rolling(window=20).mean()
    df["fsma"] = df["Close"].rolling(window=50).mean()
    df["tsma"] = df["Close"].rolling(window=10).mean()
    df['stddev'] = df['Close'].rolling(window=20).std()
    df['lower_band'] = df['20sma'] - (2 * df['stddev'])
    df['upper_band'] = df['20sma'] + (2 * df['stddev'])
    df["cp"]=df["Close"].shift(1)
    df["p1"]=abs(df["High"]-df["cp"])
    df["p2"]=abs(df["Low"]-df["cp"])
    df['p3'] = abs(df['High'] - df['Low'])
    df["TR"]=df[["p1","p2","p3"]].max(axis=1)
    df['ATR'] = df['TR'].rolling(window=20).mean()

    df['lower_keltner'] = df['20sma'] - (df['ATR'] * 1.5)
    df['upper_keltner'] = df['20sma'] + (df['ATR'] * 1.5)

    def in_squeeze(df):
        return df['lower_band'] > df['lower_keltner'] and df['upper_band'] < df['upper_keltner']


    df['squeeze_on'] = df.apply(in_squeeze, axis=1)
    df["Date"]=df.index
    if df.iloc[-3]['squeeze_on'] and not df.iloc[-1]['squeeze_on']:
        print(f"{stock} is coming out the squeeze")
    # dataframes[stock] = dfx
    x=chart_squeeze(df,stock)
    return x


def charts(name):
    # name=ticker_match(name)
    print(f"{name} charts")
    dat=get_history(symbol=name,
                           start=dt - datetime.timedelta(500),
                           end=dt)
    macd_int=MACD(dat["Close"],26,12,9)
    dat["macd"]=macd_int.macd()
    dat['mach_Histogram'] = macd_int.macd_diff()
    dat['mach_Signal'] = macd_int.macd_signal()

    rsi_indicator = RSIIndicator(dat["Close"],15)
    dat['rsi'] = rsi_indicator.rsi()

    indicator_bb = BollingerBands(close=dat["Close"], window=20, window_dev=2)


    dat["bollinger_middle"]=indicator_bb.bollinger_mavg()
    dat['bollinger_Bands_Upper'] = indicator_bb.bollinger_hband()
    dat['bollinger_Bands_Lower'] = indicator_bb.bollinger_lband()

    dat=dat.dropna()
    # print(dat)

    fig=px.line(dat,x=dat.index,y="rsi",hover_data=["Close","Volume","Low","High"], title="RSI indicator")

    fig2=px.line(dat,x=dat.index,y="bollinger_middle",hover_data=["Close","Volume","Low","High"], title="Bollinger channel")

    fig2.add_scatter(name="bollinger_Bands_Upper",x=dat.index,y=dat["bollinger_Bands_Upper"])
    fig2.add_scatter(name="bollinger_Bands_Lower",x=dat.index,y=dat["bollinger_Bands_Lower"])


    fig3=px.line(dat,x=dat.index,y="macd",hover_data=["Close","Volume","Low","High"], title="MACD 26 ema ,12 ema, 9 ema")
    fig3.add_scatter(name="signal",x=dat.index,y=dat["mach_Signal"])
    fig3.add_bar(name="bar",x=dat.index,y=dat['mach_Histogram'])


    volum_ind = AccDistIndexIndicator(dat["High"], dat["Low"], dat["Close"], dat["Volume"]) #ChaikinMoneyFlowIndicator(dat["High"], dat["Low"], dat["Close"], dat["Volume"],window=7,fillna=0)
    dat["accum"]=volum_ind.acc_dist_index()
    eom=ta.volume.VolumeWeightedAveragePrice(dat["High"], dat["Low"],dat["Close"], dat["Volume"],window=14,fillna=False)
    dat["volume_weight_price"]=eom.volume_weighted_average_price()

    trend=ta.trend.ADXIndicator(dat["High"], dat["Low"], dat["Close"])
    dat["ADX"]=trend.adx()
    dat["posadx"]=trend.adx_pos()
    dat["negadx"] = trend.adx_neg()

    voilatile=ta.volatility.AverageTrueRange(dat["High"], dat["Low"], dat["Close"],14)
    dat["volatile"]=voilatile.average_true_range()

    fig5 = px.line(dat, x=dat.index, y="Close", hover_data=["Close", "Volume", "Low", "High"],title="volume weighted average price")
    fig5.add_scatter(name="volume weighted price", x=dat.index, y=dat["volume_weight_price"])

    fig6 = px.line(dat, x=dat.index, y="ADX", hover_data=["Close", "Volume", "Low", "High"], title="ADX trend")
    fig6.add_scatter(name="+ dmi", x=dat.index, y=dat["posadx"])
    fig6.add_scatter(name="- dmi", x=dat.index, y=dat["negadx"])


    fig7 = px.bar(dat, x=dat.index, y=dat["volatile"].apply(lambda x:x*10), hover_data=["Close", "Volume", "Low", "High"],
                   title="volatile true average ")
    fig7.add_scatter(name="", x=dat.index, y=dat["Close"])

    data=dat.iloc[-35:]
    data["avg_vol"] = data["Volume"].rolling(window=10).mean()
    data["previous"] = data["Volume"].shift(1)
    data["date"] = data.index
    data.dropna()
    data=data.iloc[-10:]

    fig8=px.bar(x=data["date"],y=data["Volume"],title="volume analysis")
    fig8.add_bar(x=data["date"],y=data["avg_vol"],name="7 day avg")
    fig8.add_bar(x=data["date"], y=data["previous"], name="previous")
    fig8.add_bar( x=data["date"], y=data["Deliverable Volume"], name="delivery")
    fig8.update_layout(barmode='group')

    g=get_max_min(dat,3,10)
    p=find_patterns(g)
    fig0=plotit(p,g)
    dat=ichimoku(dat)


    labela = go.Scatter(x=dat.index, y=dat['Lead_span_A'], name='label a',
                               line={'color': 'green'})
    labelb= go.Scatter(x=dat.index, y=dat['Lead_span_B'], name="label b",
                               line={'color': 'red'})
    fig4 = go.Figure(data=[go.Candlestick(x=dat.index,
                                          open=dat['Open'],
                                          high=dat['High'],
                                          low=dat['Low'],
                                          close=dat['Close'], ),labela,labelb,fig0])

    fig4.update_layout(height=int(1000))


    return fig,fig2,fig3,fig4,fig5,fig6,fig7,fig8,dat


external_stylesheets = ['https://codepen.io/chriddyp/pen/bWLwgP.css']

app = dash.Dash(__name__, external_stylesheets=external_stylesheets)
server=app.server

app.layout = html.Div([

    dcc.Input(id="ticker",value="wipro",style={"padding":"15px","position":"center"}),
    html.Div(id="price",children=[]),])
d500={'3MINDIA': '3M India Limited', 'AARTIDRUGS': 'Aarti Drugs Limited', 'AARTIIND': 'Aarti Industries Limited', 'AAVAS': 'Aavas Financiers Limited', 'ABB': 'ABB India Limited', 'ABBOTINDIA': 'Abbott India Limited', 'ABCAPITAL': 'Aditya Birla Capital Limited', 'ABFRL': 'Aditya Birla Fashion and Retail Limited', 'ACC': 'ACC Limited', 'ADANIENT': 'Adani Enterprises Limited', 'ADANIGREEN': 'Adani Green Energy Limited', 'ADANIPORTS': 'Adani Ports and Special Economic Zone Limited', 'ADANITRANS': 'Adani Transmission Limited', 'ADVENZYMES': 'Advanced Enzyme Technologies Limited', 'AEGISCHEM': 'Aegis Logistics Limited', 'AFFLE': 'Affle (India) Limited', 'AIAENG': 'AIA Engineering Limited', 'AJANTPHARM': 'Ajanta Pharma Limited', 'AKZOINDIA': 'Akzo Nobel India Limited', 'ALEMBICLTD': 'Alembic Limited', 'ALKEM': 'Alkem Laboratories Limited', 'ALKYLAMINE': 'Alkyl Amines Chemicals Limited', 'ALOKINDS': 'Alok Industries Limited', 'AMARAJABAT': 'Amara Raja Batteries Limited', 'AMBER': 'Amber Enterprises India Limited', 'AMBUJACEM': 'Ambuja Cements Limited', 'ANGELBRKG': 'Angel Broking Limited', 'APLAPOLLO': 'APL Apollo Tubes Limited', 'APLLTD': 'Alembic Pharmaceuticals Limited', 'APOLLOHOSP': 'Apollo Hospitals Enterprise Limited', 'APOLLOTYRE': 'Apollo Tyres Limited', 'ASAHIINDIA': 'Asahi India Glass Limited', 'ASHOKA': 'Ashoka Buildcon Limited', 'ASHOKLEY': 'Ashok Leyland Limited', 'ASIANPAINT': 'Asian Paints Limited', 'ASTERDM': 'Aster DM Healthcare Limited', 'ASTRAL': 'Astral Poly Technik Limited', 'ASTRAZEN': 'AstraZeneca Pharma India Limited', 'ATGL': 'Adani Total Gas Limited', 'ATUL': 'Atul Limited', 'AUBANK': 'AU Small Finance Bank Limited', 'AUROPHARMA': 'Aurobindo Pharma Limited', 'AVANTIFEED': 'Avanti Feeds Limited', 'AXISBANK': 'Axis Bank Limited', 'BAJAJ-AUTO': 'Bajaj Auto Limited', 'BAJAJCON': 'Bajaj Consumer Care Limited', 'BAJAJELEC': 'Bajaj Electricals Limited', 'BAJAJFINSV': 'Bajaj Finserv Limited', 'BAJAJHLDNG': 'Bajaj Holdings & Investment Limited', 'BAJFINANCE': 'Bajaj Finance Limited', 'BALAMINES': 'Balaji Amines Limited', 'BALKRISIND': 'Balkrishna Industries Limited', 'BALMLAWRIE': 'Balmer Lawrie & Company Limited', 'BALRAMCHIN': 'Balrampur Chini Mills Limited', 'BANDHANBNK': 'Bandhan Bank Limited', 'BANKBARODA': 'Bank of Baroda', 'BANKINDIA': 'Bank of India', 'BASF': 'BASF India Limited', 'BATAINDIA': 'Bata India Limited', 'BAYERCROP': 'Bayer Cropscience Limited', 'BBTC': 'Bombay Burmah Trading Corporation Limited', 'BDL': 'Bharat Dynamics Limited', 'BEL': 'Bharat Electronics Limited', 'BEML': 'BEML Limited', 'BERGEPAINT': 'Berger Paints (I) Limited', 'BHARATFORG': 'Bharat Forge Limited', 'BHARATRAS': 'Bharat Rasayan Limited', 'BHARTIARTL': 'Bharti Airtel Limited', 'BHEL': 'Bharat Heavy Electricals Limited', 'BIOCON': 'Biocon Limited', 'BIRLACORPN': 'Birla Corporation Limited', 'BLISSGVS': 'Bliss GVS Pharma Limited', 'BLUEDART': 'Blue Dart Express Limited', 'BLUESTARCO': 'Blue Star Limited', 'BOSCHLTD': 'Bosch Limited', 'BPCL': 'Bharat Petroleum Corporation Limited', 'BRIGADE': 'Brigade Enterprises Limited', 'BRITANNIA': 'Britannia Industries Limited', 'BSE': 'BSE Limited', 'BSOFT': 'BIRLASOFT LIMITED', 'BURGERKING': 'Burger King India Limited', 'CADILAHC': 'Cadila Healthcare Limited', 'CAMS': 'Computer Age Management Services Limited', 'CANBK': 'Canara Bank', 'CANFINHOME': 'Can Fin Homes Limited', 'CAPLIPOINT': 'Caplin Point Laboratories Limited', 'CARBORUNIV': 'Carborundum Universal Limited', 'CASTROLIND': 'Castrol India Limited', 'CCL': 'CCL Products (India) Limited', 'CDSL': 'Central Depository Services (India) Limited', 'CEATLTD': 'CEAT Limited', 'CENTRALBK': 'Central Bank of India', 'CENTURYPLY': 'Century Plyboards (India) Limited', 'CENTURYTEX': 'Century Textiles & Industries Limited', 'CERA': 'Cera Sanitaryware Limited', 'CESC': 'CESC Limited', 'CGCL': 'Capri Global Capital Limited', 'CHALET': 'Chalet Hotels Limited', 'CHAMBLFERT': 'Chambal Fertilizers & Chemicals Limited', 'CHOLAFIN': 'Cholamandalam Investment and Finance Company Limited', 'CHOLAHLDNG': 'Cholamandalam Financial Holdings Limited', 'CIPLA': 'Cipla Limited', 'COALINDIA': 'Coal India Limited', 'COCHINSHIP': 'Cochin Shipyard Limited', 'COFORGE': 'Coforge Limited', 'COLPAL': 'Colgate Palmolive (India) Limited', 'CONCOR': 'Container Corporation of India Limited', 'COROMANDEL': 'Coromandel International Limited', 'CREDITACC': 'CREDITACCESS GRAMEEN LIMITED', 'CRISIL': 'CRISIL Limited', 'CROMPTON': 'Crompton Greaves Consumer Electricals Limited', 'CSBBANK': 'CSB Bank Limited', 'CUB': 'City Union Bank Limited', 'CUMMINSIND': 'Cummins India Limited', 'CYIENT': 'Cyient Limited', 'DABUR': 'Dabur India Limited', 'DALBHARAT': 'Dalmia Bharat Limited', 'DBL': 'Dilip Buildcon Limited', 'DCAL': 'Dishman Carbogen Amcis Limited', 'DCBBANK': 'DCB Bank Limited', 'DCMSHRIRAM': 'DCM Shriram Limited', 'DEEPAKNTR': 'Deepak Nitrite Limited', 'DELTACORP': 'Delta Corp Limited', 'DHANI': 'Dhani Services Limited', 'DHANUKA': 'Dhanuka Agritech Limited', 'DISHTV': 'Dish TV India Limited', 'DIVISLAB': "Divi's Laboratories Limited", 'DIXON': 'Dixon Technologies (India) Limited', 'DLF': 'DLF Limited', 'DMART': 'Avenue Supermarts Limited', 'DRREDDY': "Dr. Reddy's Laboratories Limited", 'ECLERX': 'eClerx Services Limited', 'EDELWEISS': 'Edelweiss Financial Services Limited', 'EICHERMOT': 'Eicher Motors Limited', 'EIDPARRY': 'EID Parry India Limited', 'EIHOTEL': 'EIH Limited', 'ELGIEQUIP': 'Elgi Equipments Limited', 'EMAMILTD': 'Emami Limited', 'ENDURANCE': 'Endurance Technologies Limited', 'ENGINERSIN': 'Engineers India Limited', 'EPL': 'EPL Limited', 'EQUITAS': 'Equitas Holdings Limited', 'ERIS': 'Eris Lifesciences Limited', 'ESCORTS': 'Escorts Limited', 'EXIDEIND': 'Exide Industries Limited', 'FCONSUMER': 'Future Consumer Limited', 'FDC': 'FDC Limited', 'FEDERALBNK': 'The Federal Bank  Limited', 'FINCABLES': 'Finolex Cables Limited', 'FINEORG': 'Fine Organic Industries Limited', 'FINPIPE': 'Finolex Industries Limited', 'FLUOROCHEM': 'Gujarat Fluorochemicals Limited', 'FORTIS': 'Fortis Healthcare Limited', 'FRETAIL': 'Future Retail Limited', 'FSL': 'Firstsource Solutions Limited', 'GAEL': 'Gujarat Ambuja Exports Limited', 'GAIL': 'GAIL (India) Limited', 'GALAXYSURF': 'Galaxy Surfactants Limited', 'GARFIBRES': 'Garware Technical Fibres Limited', 'GEPIL': 'GE Power India Limited', 'GESHIP': 'The Great Eastern Shipping Company Limited', 'GICRE': 'General Insurance Corporation of India', 'GILLETTE': 'Gillette India Limited', 'GLAXO': 'GlaxoSmithKline Pharmaceuticals Limited', 'GLENMARK': 'Glenmark Pharmaceuticals Limited', 'GMMPFAUDLR': 'GMM Pfaudler Limited', 'GMRINFRA': 'GMR Infrastructure Limited', 'GNFC': 'Gujarat Narmada Valley Fertilizers and Chemicals Limited', 'GODFRYPHLP': 'Godfrey Phillips India Limited', 'GODREJAGRO': 'Godrej Agrovet Limited', 'GODREJCP': 'Godrej Consumer Products Limited', 'GODREJIND': 'Godrej Industries Limited', 'GODREJPROP': 'Godrej Properties Limited', 'GPPL': 'Gujarat Pipavav Port Limited', 'GRANULES': 'Granules India Limited', 'GRAPHITE': 'Graphite India Limited', 'GRASIM': 'Grasim Industries Limited', 'GREAVESCOT': 'Greaves Cotton Limited', 'GRINDWELL': 'Grindwell Norton Limited', 'GRSE': 'Garden Reach Shipbuilders & Engineers Limited', 'GSFC': 'Gujarat State Fertilizers & Chemicals Limited', 'GSPL': 'Gujarat State Petronet Limited', 'GUJALKALI': 'Gujarat Alkalies and Chemicals Limited', 'GUJGASLTD': 'Gujarat Gas Limited', 'GULFOILLUB': 'Gulf Oil Lubricants India Limited', 'HAL': 'Hindustan Aeronautics Limited', 'HAPPSTMNDS': 'Happiest Minds Technologies Limited', 'HATSUN': 'Hatsun Agro Product Limited', 'HAVELLS': 'Havells India Limited', 'HCLTECH': 'HCL Technologies Limited', 'HDFC': 'Housing Development Finance Corporation Limited', 'HDFCAMC': 'HDFC Asset Management Company Limited', 'HDFCBANK': 'HDFC Bank Limited', 'HDFCLIFE': 'HDFC Life Insurance Company Limited', 'HEG': 'HEG Limited', 'HEIDELBERG': 'HeidelbergCement India Limited', 'HEMIPROP': 'Hemisphere Properties India Limited', 'HEROMOTOCO': 'Hero MotoCorp Limited', 'HFCL': 'HFCL Limited', 'HINDALCO': 'Hindalco Industries Limited', 'HINDCOPPER': 'Hindustan Copper Limited', 'HINDPETRO': 'Hindustan Petroleum Corporation Limited', 'HINDUNILVR': 'Hindustan Unilever Limited', 'HINDZINC': 'Hindustan Zinc Limited', 'HONAUT': 'Honeywell Automation India Limited', 'HSCL': 'Himadri Speciality Chemical Limited', 'HUDCO': 'Housing & Urban Development Corporation Limited', 'HUHTAMAKI': 'Huhtamaki India Limited', 'IBREALEST': 'Indiabulls Real Estate Limited', 'IBULHSGFIN': 'Indiabulls Housing Finance Limited', 'ICICIBANK': 'ICICI Bank Limited', 'ICICIGI': 'ICICI Lombard General Insurance Company Limited', 'ICICIPRULI': 'ICICI Prudential Life Insurance Company Limited', 'ICIL': 'Indo Count Industries Limited', 'IDBI': 'IDBI Bank Limited', 'IDEA': 'Vodafone Idea Limited', 'IDFC': 'IDFC Limited', 'IDFCFIRSTB': 'IDFC First Bank Limited', 'IEX': 'Indian Energy Exchange Limited', 'IFBIND': 'IFB Industries Limited', 'IGL': 'Indraprastha Gas Limited', 'IIFL': 'IIFL Finance Limited', 'IIFLWAM': 'Iifl Wealth Management Limited', 'INDHOTEL': 'The Indian Hotels Company Limited', 'INDIACEM': 'The India Cements Limited', 'INDIAMART': 'Indiamart Intermesh Limited', 'INDIANB': 'Indian Bank', 'INDIGO': 'InterGlobe Aviation Limited', 'INDOCO': 'Indoco Remedies Limited', 'INDUSINDBK': 'IndusInd Bank Limited', 'INDUSTOWER': 'Indus Towers Limited', 'INFIBEAM': 'Infibeam Avenues Limited', 'INFY': 'Infosys Limited', 'INGERRAND': 'Ingersoll Rand (India) Limited', 'INOXLEISUR': 'INOX Leisure Limited', 'INTELLECT': 'Intellect Design Arena Limited', 'IOB': 'Indian Overseas Bank', 'IOC': 'Indian Oil Corporation Limited', 'IOLCP': 'IOL Chemicals and Pharmaceuticals Limited', 'IPCALAB': 'IPCA Laboratories Limited', 'IRB': 'IRB Infrastructure Developers Limited', 'IRCON': 'Ircon International Limited', 'IRCTC': 'Indian Railway Catering And Tourism Corporation Limited', 'ISEC': 'ICICI Securities Limited', 'ITC': 'ITC Limited', 'ITI': 'ITI Limited', 'JAMNAAUTO': 'Jamna Auto Industries Limited', 'JBCHEPHARM': 'JB Chemicals & Pharmaceuticals Limited', 'JCHAC': 'Johnson Controls - Hitachi Air Conditioning India Limited', 'JINDALSAW': 'Jindal Saw Limited', 'JINDALSTEL': 'Jindal Steel & Power Limited', 'JKCEMENT': 'JK Cement Limited', 'JKLAKSHMI': 'JK Lakshmi Cement Limited', 'JKPAPER': 'JK Paper Limited', 'JKTYRE': 'JK Tyre & Industries Limited', 'JMFINANCIL': 'JM Financial Limited', 'JSL': 'Jindal Stainless Limited', 'JSLHISAR': 'Jindal Stainless (Hisar) Limited', 'JSWENERGY': 'JSW Energy Limited', 'JSWSTEEL': 'JSW Steel Limited', 'JTEKTINDIA': 'Jtekt India Limited', 'JUBLFOOD': 'Jubilant Foodworks Limited', 'JUSTDIAL': 'Just Dial Limited', 'JYOTHYLAB': 'Jyothy Labs Limited', 'KAJARIACER': 'Kajaria Ceramics Limited', 'KALPATPOWR': 'Kalpataru Power Transmission Limited', 'KANSAINER': 'Kansai Nerolac Paints Limited', 'KARURVYSYA': 'Karur Vysya Bank Limited', 'KEC': 'KEC International Limited', 'KEI': 'KEI Industries Limited', 'KNRCON': 'KNR Constructions Limited', 'KOTAKBANK': 'Kotak Mahindra Bank Limited', 'KPITTECH': 'KPIT Technologies Limited', 'KPRMILL': 'K.P.R. Mill Limited', 'KRBL': 'KRBL Limited', 'KSB': 'Ksb Limited', 'KSCL': 'Kaveri Seed Company Limited', 'L&TFH': 'L&T Finance Holdings Limited', 'LALPATHLAB': 'Dr. Lal Path Labs Ltd.', 'LAOPALA': 'La Opala RG Limited', 'LAURUSLABS': 'Laurus Labs Limited', 'LAXMIMACH': 'Lakshmi Machine Works Limited', 'LEMONTREE': 'Lemon Tree Hotels Limited', 'LICHSGFIN': 'LIC Housing Finance Limited', 'LINDEINDIA': 'Linde India Limited', 'LT': 'Larsen & Toubro Limited', 'LTI': 'Larsen & Toubro Infotech Limited', 'LTTS': 'L&T Technology Services Limited', 'LUPIN': 'Lupin Limited', 'LUXIND': 'Lux Industries Limited', 'M&M': 'Mahindra & Mahindra Limited', 'M&MFIN': 'Mahindra & Mahindra Financial Services Limited', 'MAHABANK': 'Bank of Maharashtra', 'MAHINDCIE': 'Mahindra CIE Automotive Limited', 'MAHLOG': 'Mahindra Logistics Limited', 'MAHSCOOTER': 'Maharashtra Scooters Limited', 'MAHSEAMLES': 'Maharashtra Seamless Limited', 'MANAPPURAM': 'Manappuram Finance Limited', 'MARICO': 'Marico Limited', 'MARUTI': 'Maruti Suzuki India Limited', 'MASFIN': 'MAS Financial Services Limited', 'MAXHEALTH': 'Max Healthcare Institute Limited', 'MAZDOCK': 'Mazagon Dock Shipbuilders Limited', 'MCDOWELL-N': 'United Spirits Limited', 'MCX': 'Multi Commodity Exchange of India Limited', 'METROPOLIS': 'Metropolis Healthcare Limited', 'MFSL': 'Max Financial Services Limited', 'MGL': 'Mahanagar Gas Limited', 'MHRIL': 'Mahindra Holidays & Resorts India Limited', 'MIDHANI': 'Mishra Dhatu Nigam Limited', 'MINDACORP': 'Minda Corporation Limited', 'MINDAIND': 'Minda Industries Limited', 'MINDTREE': 'MindTree Limited', 'MMTC': 'MMTC Limited', 'MOIL': 'MOIL Limited', 'MOTHERSUMI': 'Motherson Sumi Systems Limited', 'MOTILALOFS': 'Motilal Oswal Financial Services Limited', 'MPHASIS': 'MphasiS Limited', 'MRF': 'MRF Limited', 'MRPL': 'Mangalore Refinery and Petrochemicals Limited', 'MUTHOOTFIN': 'Muthoot Finance Limited', 'NAM-INDIA': 'Nippon Life India Asset Management Limited', 'NATCOPHARM': 'Natco Pharma Limited', 'NATIONALUM': 'National Aluminium Company Limited', 'NAUKRI': 'Info Edge (India) Limited', 'NAVINFLUOR': 'Navin Fluorine International Limited', 'NBCC': 'NBCC (India) Limited', 'NCC': 'NCC Limited', 'NESCO': 'Nesco Limited', 'NESTLEIND': 'Nestle India Limited', 'NETWORK18': 'Network18 Media & Investments Limited', 'NFL': 'National Fertilizers Limited', 'NH': 'Narayana Hrudayalaya Ltd.', 'NHPC': 'NHPC Limited', 'NIACL': 'The New India Assurance Company Limited', 'NILKAMAL': 'Nilkamal Limited', 'NLCINDIA': 'NLC India Limited', 'NMDC': 'NMDC Limited', 'NOCIL': 'NOCIL Limited', 'NTPC': 'NTPC Limited', 'OBEROIRLTY': 'Oberoi Realty Limited', 'OFSS': 'Oracle Financial Services Software Limited', 'OIL': 'Oil India Limited', 'ONGC': 'Oil & Natural Gas Corporation Limited', 'ORIENTELEC': 'Orient Electric Limited', 'ORIENTREF': 'Orient Refractories Limited', 'PAGEIND': 'Page Industries Limited', 'PEL': 'Piramal Enterprises Limited', 'PERSISTENT': 'Persistent Systems Limited', 'PETRONET': 'Petronet LNG Limited', 'PFC': 'Power Finance Corporation Limited', 'PFIZER': 'Pfizer Limited', 'PGHH': 'Procter & Gamble Hygiene and Health Care Limited', 'PGHL': 'Procter & Gamble Health Limited', 'PHILIPCARB': 'Phillips Carbon Black Limited', 'PHOENIXLTD': 'The Phoenix Mills Limited', 'PIDILITIND': 'Pidilite Industries Limited', 'PIIND': 'PI Industries Limited', 'PNB': 'Punjab National Bank', 'PNBHOUSING': 'PNB Housing Finance Limited', 'PNCINFRA': 'PNC Infratech Limited', 'POLYCAB': 'Polycab India Limited', 'POLYMED': 'Poly Medicure Limited', 'POLYPLEX': 'Polyplex Corporation Limited', 'POWERGRID': 'Power Grid Corporation of India Limited', 'POWERINDIA': 'ABB Power Products and Systems India Limited', 'PRESTIGE': 'Prestige Estates Projects Limited', 'PRINCEPIPE': 'Prince Pipes And Fittings Limited', 'PRSMJOHNSN': 'Prism Johnson Limited', 'PVR': 'PVR Limited', 'QUESS': 'Quess Corp Limited', 'RADICO': 'Radico Khaitan Limited', 'RAIN': 'Rain Industries Limited', 'RAJESHEXPO': 'Rajesh Exports Limited', 'RALLIS': 'Rallis India Limited', 'RAMCOCEM': 'The Ramco Cements Limited', 'RATNAMANI': 'Ratnamani Metals & Tubes Limited', 'RAYMOND': 'Raymond Limited', 'RBLBANK': 'RBL Bank Limited', 'RCF': 'Rashtriya Chemicals and Fertilizers Limited', 'RECLTD': 'REC Limited', 'REDINGTON': 'Redington (India) Limited', 'RELAXO': 'Relaxo Footwears Limited', 'RELIANCE': 'Reliance Industries Limited', 'RESPONIND': 'Responsive Industries Limited', 'RITES': 'RITES Limited', 'ROSSARI': 'Rossari Biotech Limited', 'ROUTE': 'ROUTE MOBILE LIMITED', 'RVNL': 'Rail Vikas Nigam Limited', 'SAIL': 'Steel Authority of India Limited', 'SANOFI': 'Sanofi India Limited', 'SBICARD': 'SBI Cards and Payment Services Limited', 'SBILIFE': 'SBI Life Insurance Company Limited', 'SBIN': 'State Bank of India', 'SCHAEFFLER': 'Schaeffler India Limited', 'SCHNEIDER': 'Schneider Electric Infrastructure Limited', 'SCI': 'Shipping Corporation Of India Limited', 'SEQUENT': 'Sequent Scientific Limited', 'SFL': 'Sheela Foam Limited', 'SHARDACROP': 'Sharda Cropchem Limited', 'SHILPAMED': 'Shilpa Medicare Limited', 'SHOPERSTOP': 'Shoppers Stop Limited', 'SHREECEM': 'SHREE CEMENT LIMITED', 'SHRIRAMCIT': 'Shriram City Union Finance Limited', 'SIEMENS': 'Siemens Limited', 'SIS': 'SIS LIMITED', 'SJVN': 'SJVN Limited', 'SKFINDIA': 'SKF India Limited', 'SOBHA': 'Sobha Limited', 'SOLARA': 'Solara Active Pharma Sciences Limited', 'SOLARINDS': 'Solar Industries India Limited', 'SONATSOFTW': 'Sonata Software Limited', 'SPANDANA': 'Spandana Sphoorty Financial Limited', 'SPARC': 'Sun Pharma Advanced Research Company Limited', 'SPICEJET': 'SPICEJET LTD', 'SRF': 'SRF Limited', 'SRTRANSFIN': 'Shriram Transport Finance Company Limited', 'STAR': 'Strides Pharma Science Limited', 'STARCEMENT': 'Star Cement Limited', 'STLTECH': 'Sterlite Technologies Limited', 'SUDARSCHEM': 'Sudarshan Chemical Industries Limited', 'SUMICHEM': 'Sumitomo Chemical India Limited', 'SUNCLAYLTD': 'Sundaram Clayton Limited', 'SUNDARMFIN': 'Sundaram Finance Limited', 'SUNDRMFAST': 'Sundram Fasteners Limited', 'SUNPHARMA': 'Sun Pharmaceutical Industries Limited', 'SUNTECK': 'Sunteck Realty Limited', 'SUNTV': 'Sun TV Network Limited', 'SUPPETRO': 'Supreme Petrochem Limited', 'SUPRAJIT': 'Suprajit Engineering Limited', 'SUPREMEIND': 'Supreme Industries Limited', 'SUVENPHAR': 'Suven Pharmaceuticals Limited', 'SUZLON': 'Suzlon Energy Limited', 'SWANENERGY': 'Swan Energy Limited', 'SWSOLAR': 'Sterling And Wilson Solar Limited', 'SYMPHONY': 'Symphony Limited', 'SYNGENE': 'Syngene International Limited', 'TANLA': 'Tanla Platforms Limited', 'TASTYBITE': 'Tasty Bite Eatables Limited', 'TATACHEM': 'Tata Chemicals Limited', 'TATACOFFEE': 'Tata Coffee Limited', 'TATACOMM': 'Tata Communications Limited', 'TATACONSUM': 'TATA CONSUMER PRODUCTS LIMITED', 'TATAELXSI': 'Tata Elxsi Limited', 'TATAINVEST': 'Tata Investment Corporation Limited', 'TATAMOTORS': 'Tata Motors Limited', 'TATAMTRDVR': 'Tata Motors Limited', 'TATAPOWER': 'Tata Power Company Limited', 'TATASTEEL': 'Tata Steel Limited', 'TCIEXP': 'TCI Express Limited', 'TCNSBRANDS': 'TCNS Clothing Co. Limited', 'TCS': 'Tata Consultancy Services Limited', 'TEAMLEASE': 'Teamlease Services Limited', 'TECHM': 'Tech Mahindra Limited', 'THERMAX': 'Thermax Limited', 'THYROCARE': 'Thyrocare Technologies Limited', 'TIINDIA': 'Tube Investments of India Limited', 'TIMKEN': 'Timken India Limited', 'TITAN': 'Titan Company Limited', 'TORNTPHARM': 'Torrent Pharmaceuticals Limited', 'TORNTPOWER': 'Torrent Power Limited', 'TRENT': 'Trent Limited', 'TRIDENT': 'Trident Limited', 'TRITURBINE': 'Triveni Turbine Limited', 'TTKPRESTIG': 'TTK Prestige Limited', 'TV18BRDCST': 'TV18 Broadcast Limited', 'TVSMOTOR': 'TVS Motor Company Limited', 'UBL': 'United Breweries Limited', 'UCOBANK': 'UCO Bank', 'UFLEX': 'UFLEX Limited', 'UJJIVAN': 'Ujjivan Financial Services Limited', 'UJJIVANSFB': 'Ujjivan Small Finance Bank Limited', 'ULTRACEMCO': 'UltraTech Cement Limited', 'UNIONBANK': 'Union Bank of India', 'UPL': 'UPL Limited', 'UTIAMC': 'UTI Asset Management Company Limited', 'VAIBHAVGBL': 'Vaibhav Global Limited', 'VAKRANGEE': 'Vakrangee Limited', 'VALIANTORG': 'Valiant Organics Limited', 'VARROC': 'Varroc Engineering Limited', 'VBL': 'Varun Beverages Limited', 'VEDL': 'Vedanta Limited', 'VENKEYS': "Venky's (India) Limited", 'VGUARD': 'V-Guard Industries Limited', 'VINATIORGA': 'Vinati Organics Limited', 'VIPIND': 'VIP Industries Limited', 'VMART': 'V-Mart Retail Limited', 'VOLTAS': 'Voltas Limited', 'VSTIND': 'VST Industries Limited', 'VTL': 'Vardhman Textiles Limited', 'WABCOINDIA': 'WABCO India Limited', 'WELCORP': 'Welspun Corp Limited', 'WELSPUNIND': 'Welspun India Limited', 'WESTLIFE': 'Westlife Development Ltd', 'WHIRLPOOL': 'Whirlpool of India Limited', 'WIPRO': 'Wipro Limited', 'WOCKPHARMA': 'Wockhardt Limited', 'YESBANK': 'Yes Bank Limited', 'ZEEL': 'Zee Entertainment Enterprises Limited', 'ZENSARTECH': 'Zensar Technologies Limited', 'ZYDUSWELL': 'Zydus Wellness Limited'}

@app.callback(Output('price', 'children'),
              [Input("ticker","value")],)
def djhfj(value):
    try:
        print(value)
        value=ticker_match(value)
        print("predicted",value)
        ch=charts(value)
        sector=yfinance.Ticker(value+
                               ".NS").info["sector"]
        name=d500[value]
        return html.Div([
            html.Div(value.upper() +  " - - - "+ name +  " - - - "+"[ "+sector+" ]",style={"color":"blue"}),
            dcc.Graph(figure=ch[0]),
            dcc.Graph(figure=ch[1]),
            dcc.Graph(figure=ch[2]),
            dcc.Graph(figure=ch[3]),
            dcc.Graph(figure=ch[4]),
            dcc.Graph(figure=ch[5]),
            dcc.Graph(figure=ch[6]),
            dcc.Graph(figure=ch[7]),
            #dcc.Graph(figure=market_sentiment(value.split(".")[0])),
            dcc.Graph(figure=squeeze_chart(ch[8],value)),

        ])
    except:
        return html.Div([
            html.Div("ERROR LOADING CHARTS", style={"color": "red"}),
             ])
if __name__ == '__main__':
    app.run_server(debug=True,port=7800)
